{"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/utils/JwtUtils.ts":{"path":"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/utils/JwtUtils.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":12},"end":{"line":3,"column":35}},"2":{"start":{"line":6,"column":8},"end":{"line":6,"column":60}},"3":{"start":{"line":9,"column":8},"end":{"line":9,"column":49}},"4":{"start":{"line":12,"column":29},"end":{"line":12,"column":45}},"5":{"start":{"line":13,"column":8},"end":{"line":13,"column":59}},"6":{"start":{"line":16,"column":29},"end":{"line":16,"column":45}},"7":{"start":{"line":17,"column":8},"end":{"line":17,"column":43}},"8":{"start":{"line":20,"column":8},"end":{"line":20,"column":51}},"9":{"start":{"line":23,"column":0},"end":{"line":23,"column":27}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":5,"column":4},"end":{"line":5,"column":5}},"loc":{"start":{"line":5,"column":18},"end":{"line":7,"column":5}},"line":5},"1":{"name":"(anonymous_1)","decl":{"start":{"line":8,"column":4},"end":{"line":8,"column":5}},"loc":{"start":{"line":8,"column":18},"end":{"line":10,"column":5}},"line":8},"2":{"name":"(anonymous_2)","decl":{"start":{"line":11,"column":4},"end":{"line":11,"column":5}},"loc":{"start":{"line":11,"column":18},"end":{"line":14,"column":5}},"line":11},"3":{"name":"(anonymous_3)","decl":{"start":{"line":15,"column":4},"end":{"line":15,"column":5}},"loc":{"start":{"line":15,"column":18},"end":{"line":18,"column":5}},"line":15},"4":{"name":"(anonymous_4)","decl":{"start":{"line":19,"column":4},"end":{"line":19,"column":5}},"loc":{"start":{"line":19,"column":19},"end":{"line":21,"column":5}},"line":19}},"branchMap":{"0":{"loc":{"start":{"line":6,"column":25},"end":{"line":6,"column":59}},"type":"binary-expr","locations":[{"start":{"line":6,"column":25},"end":{"line":6,"column":47}},{"start":{"line":6,"column":51},"end":{"line":6,"column":59}}],"line":6}},"s":{"0":1,"1":1,"2":6,"3":1,"4":1,"5":1,"6":1,"7":1,"8":2,"9":1},"f":{"0":6,"1":1,"2":1,"3":1,"4":2},"b":{"0":[6,1]},"inputSourceMap":{"version":3,"file":"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/utils/JwtUtils.ts","sources":["/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/utils/JwtUtils.ts"],"names":[],"mappings":";;AAAA,oCAAoC;AAGpC,MAAqB,QAAQ;IAA7B;QACU,cAAS,GAAG,OAAO,CAAC,GAAG,CAAC,UAAU,IAAI,QAAQ,CAAC;IAmBzD,CAAC;IAjBC,IAAI,CAAC,OAAgE;QACnE,OAAO,GAAG,CAAC,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC;IAC3C,CAAC;IAED,MAAM,CAAC,KAAa;QAClB,MAAM,YAAY,GAAG,KAAK,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;QACtC,OAAO,GAAG,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC,CAAC,EAAE,IAAI,CAAC,SAAS,CAA4D,CAAC;IAChH,CAAC;IAED,MAAM,CAAC,KAAa;QAClB,MAAM,YAAY,GAAG,KAAK,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;QACtC,OAAO,GAAG,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC,CAAC,CAA4D,CAAC;IAChG,CAAC;IAED,OAAO,CAAC,KAAa;QACnB,OAAO,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,IAAI,KAAK,OAAO,CAAC;IAC7C,CAAC;CACF;AApBD,2BAoBC","sourcesContent":["import * as jwt from 'jsonwebtoken';\nimport { Identifiable } from '../interfaces';\n\nexport default class JwtUtils {\n  private jwtSecret = process.env.JWT_SECRET || 'secret';\n\n  sign(payload: { id: Identifiable['id'], email: string, role: string }): string {\n    return jwt.sign(payload, this.jwtSecret);\n  }\n\n  verify(token: string): { id: Identifiable['id'], email: string, role: string } {\n    const bearerNToken = token.split(' ');\n    return jwt.verify(bearerNToken[1], this.jwtSecret) as { id: Identifiable['id'], email: string, role: string };\n  }\n\n  decode(token: string): { id: Identifiable['id'], email: string, role: string } {\n    const bearerNToken = token.split(' ');\n    return jwt.decode(bearerNToken[1]) as { id: Identifiable['id'], email: string, role: string };\n  }\n\n  isAdmin(token: string): boolean {\n    return this.decode(token).role === 'admin';\n  }\n}"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"c6744f1fdcbb758ae0188a0b536e24d670b7964a"},"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/app.ts":{"path":"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/app.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":21}},"2":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"3":{"start":{"line":5,"column":17},"end":{"line":5,"column":36}},"4":{"start":{"line":8,"column":8},"end":{"line":8,"column":29}},"5":{"start":{"line":9,"column":8},"end":{"line":9,"column":22}},"6":{"start":{"line":10,"column":8},"end":{"line":10,"column":22}},"7":{"start":{"line":13,"column":30},"end":{"line":18,"column":9}},"8":{"start":{"line":14,"column":12},"end":{"line":14,"column":59}},"9":{"start":{"line":15,"column":12},"end":{"line":15,"column":92}},"10":{"start":{"line":16,"column":12},"end":{"line":16,"column":60}},"11":{"start":{"line":17,"column":12},"end":{"line":17,"column":19}},"12":{"start":{"line":19,"column":8},"end":{"line":19,"column":37}},"13":{"start":{"line":20,"column":8},"end":{"line":20,"column":36}},"14":{"start":{"line":23,"column":8},"end":{"line":23,"column":39}},"15":{"start":{"line":26,"column":8},"end":{"line":26,"column":76}},"16":{"start":{"line":26,"column":36},"end":{"line":26,"column":74}},"17":{"start":{"line":29,"column":0},"end":{"line":29,"column":22}},"18":{"start":{"line":30,"column":0},"end":{"line":30,"column":28}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":7,"column":4},"end":{"line":7,"column":5}},"loc":{"start":{"line":7,"column":18},"end":{"line":11,"column":5}},"line":7},"1":{"name":"(anonymous_1)","decl":{"start":{"line":12,"column":4},"end":{"line":12,"column":5}},"loc":{"start":{"line":12,"column":13},"end":{"line":21,"column":5}},"line":12},"2":{"name":"(anonymous_2)","decl":{"start":{"line":13,"column":30},"end":{"line":13,"column":31}},"loc":{"start":{"line":13,"column":51},"end":{"line":18,"column":9}},"line":13},"3":{"name":"(anonymous_3)","decl":{"start":{"line":22,"column":4},"end":{"line":22,"column":5}},"loc":{"start":{"line":22,"column":13},"end":{"line":24,"column":5}},"line":22},"4":{"name":"(anonymous_4)","decl":{"start":{"line":25,"column":4},"end":{"line":25,"column":5}},"loc":{"start":{"line":25,"column":16},"end":{"line":27,"column":5}},"line":25},"5":{"name":"(anonymous_5)","decl":{"start":{"line":26,"column":30},"end":{"line":26,"column":31}},"loc":{"start":{"line":26,"column":36},"end":{"line":26,"column":74}},"line":26}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":34,"9":34,"10":34,"11":34,"12":1,"13":1,"14":1,"15":0,"16":0,"17":1,"18":1},"f":{"0":1,"1":1,"2":34,"3":1,"4":0,"5":0},"b":{},"inputSourceMap":{"version":3,"file":"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/app.ts","sources":["/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/app.ts"],"names":[],"mappings":";;;AAAA,mCAAmC;AACnC,qCAA8B;AAE9B,MAAM,GAAG;IAGP;QACE,IAAI,CAAC,GAAG,GAAG,OAAO,EAAE,CAAC;QACrB,IAAI,CAAC,MAAM,EAAE,CAAC;QACd,IAAI,CAAC,MAAM,EAAE,CAAC;IAChB,CAAC;IAEO,MAAM;QACZ,MAAM,aAAa,GAA2B,CAAC,IAAI,EAAE,GAAG,EAAE,IAAI,EAAE,EAAE;YAChE,GAAG,CAAC,MAAM,CAAC,6BAA6B,EAAE,GAAG,CAAC,CAAC;YAC/C,GAAG,CAAC,MAAM,CAAC,8BAA8B,EAAE,mCAAmC,CAAC,CAAC;YAChF,GAAG,CAAC,MAAM,CAAC,8BAA8B,EAAE,GAAG,CAAC,CAAC;YAChD,IAAI,EAAE,CAAC;QACT,CAAC,CAAA;QACD,IAAI,CAAC,GAAG,CAAC,GAAG,CAAC,OAAO,CAAC,IAAI,EAAE,CAAC,CAAC;QAC7B,IAAI,CAAC,GAAG,CAAC,GAAG,CAAC,aAAa,CAAC,CAAC;IAC9B,CAAC;IAEO,MAAM;QACZ,IAAI,CAAC,GAAG,CAAC,GAAG,CAAC,gBAAM,CAAC,CAAC;IACvB,CAAC;IAEM,KAAK,CAAC,IAAqB;QAChC,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,IAAI,EAAE,GAAG,EAAE,CAAC,OAAO,CAAC,GAAG,CAAC,mBAAmB,IAAI,EAAE,CAAC,CAAC,CAAC;IACtE,CAAC;CACF;AAED,kBAAe,GAAG,CAAC;AACJ,WAAG,GAAK,IAAI,GAAG,EAAE,KAAC","sourcesContent":["import * as express from 'express';\nimport router from './routes';\n\nclass App {\n  public app: express.Express;   \n  \n  constructor() {\n    this.app = express();\n    this.config();\n    this.routes();\n  }\n\n  private config(): void {\n    const accessControl: express.RequestHandler = (_req, res, next) => {\n      res.header('Access-Control-Allow-Origin', '*');\n      res.header('Access-Control-Allow-Methods', 'GET,POST,DELETE,OPTIONS,PUT,PATCH');\n      res.header('Access-Control-Allow-Headers', '*');\n      next();\n    }\n    this.app.use(express.json());\n    this.app.use(accessControl);\n  }\n  \n  private routes(): void {\n    this.app.use(router);\n  }\n\n  public start(PORT: string | number) {\n    this.app.listen(PORT, () => console.log(`Running on port ${PORT}`));\n  }\n}\n\nexport default App;\nexport const { app } = new App();\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"584874d7a6d1ea47bf5af348f3a721553baf8095"},"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/routes/index.ts":{"path":"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/routes/index.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":18},"end":{"line":3,"column":36}},"2":{"start":{"line":4,"column":24},"end":{"line":4,"column":50}},"3":{"start":{"line":5,"column":22},"end":{"line":5,"column":46}},"4":{"start":{"line":6,"column":25},"end":{"line":6,"column":52}},"5":{"start":{"line":7,"column":23},"end":{"line":7,"column":48}},"6":{"start":{"line":8,"column":15},"end":{"line":8,"column":38}},"7":{"start":{"line":9,"column":0},"end":{"line":9,"column":47}},"8":{"start":{"line":10,"column":0},"end":{"line":10,"column":43}},"9":{"start":{"line":11,"column":0},"end":{"line":11,"column":49}},"10":{"start":{"line":12,"column":0},"end":{"line":12,"column":45}},"11":{"start":{"line":13,"column":0},"end":{"line":13,"column":25}}},"fnMap":{},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1},"f":{},"b":{},"inputSourceMap":{"version":3,"file":"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/routes/index.ts","sources":["/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/routes/index.ts"],"names":[],"mappings":";;AAAA,qCAAiC;AACjC,mDAAyC;AACzC,+CAAuC;AACvC,qDAA4C;AAC5C,iDAAyC;AAEzC,MAAM,MAAM,GAAG,IAAA,gBAAM,GAAE,CAAC;AAExB,MAAM,CAAC,GAAG,CAAC,SAAS,EAAE,uBAAW,CAAC,CAAC;AACnC,MAAM,CAAC,GAAG,CAAC,OAAO,EAAE,qBAAU,CAAC,CAAC;AAChC,MAAM,CAAC,GAAG,CAAC,UAAU,EAAE,wBAAY,CAAC,CAAC;AACrC,MAAM,CAAC,GAAG,CAAC,QAAQ,EAAE,sBAAW,CAAC,CAAC;AAElC,kBAAe,MAAM,CAAC","sourcesContent":["import { Router } from \"express\";\nimport eventRouter from './events.routes'\nimport userRouter from './user.routes';\nimport ticketRouter from './tickets.routes';\nimport adminRouter from './admin.routes';\n\nconst router = Router();\n\nrouter.use('/events', eventRouter);\nrouter.use('/user', userRouter);\nrouter.use('/tickets', ticketRouter);\nrouter.use('/admin', adminRouter);\n\nexport default router;"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"1fa0746b5daa80874392c4c9df6d44d40071eb4b"},"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/routes/events.routes.ts":{"path":"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/routes/events.routes.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":18},"end":{"line":3,"column":36}},"2":{"start":{"line":4,"column":26},"end":{"line":4,"column":67}},"3":{"start":{"line":5,"column":24},"end":{"line":5,"column":55}},"4":{"start":{"line":6,"column":15},"end":{"line":6,"column":38}},"5":{"start":{"line":7,"column":0},"end":{"line":7,"column":65}},"6":{"start":{"line":7,"column":30},"end":{"line":7,"column":63}},"7":{"start":{"line":8,"column":0},"end":{"line":8,"column":25}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":7,"column":16},"end":{"line":7,"column":17}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":63}},"line":7}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":3,"7":1},"f":{"0":3},"b":{},"inputSourceMap":{"version":3,"file":"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/routes/events.routes.ts","sources":["/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/routes/events.routes.ts"],"names":[],"mappings":";;AAAA,qCAAoD;AACpD,oEAA6D;AAE7D,MAAM,eAAe,GAAG,IAAI,yBAAe,EAAE,CAAC;AAC9C,MAAM,MAAM,GAAG,IAAA,gBAAM,GAAE,CAAC;AAExB,MAAM,CAAC,GAAG,CAAC,GAAG,EAAE,CAAC,GAAY,EAAE,GAAa,EAAE,EAAE,CAAC,eAAe,CAAC,OAAO,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC,CAAC;AAEpF,kBAAe,MAAM,CAAC","sourcesContent":["import { Request, Router, Response } from 'express';\nimport EventController from '../controllers/EventController';\n\nconst eventController = new EventController();\nconst router = Router();\n\nrouter.get('/', (req: Request, res: Response) => eventController.findAll(req, res));\n\nexport default router;"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"3e656eddf7668e90a670c1ff1b749e9bfbf51b43"},"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/controllers/EventController.ts":{"path":"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/controllers/EventController.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":23},"end":{"line":3,"column":58}},"2":{"start":{"line":4,"column":24},"end":{"line":4,"column":57}},"3":{"start":{"line":7,"column":8},"end":{"line":7,"column":41}},"4":{"start":{"line":10,"column":22},"end":{"line":10,"column":47}},"5":{"start":{"line":11,"column":23},"end":{"line":11,"column":61}},"6":{"start":{"line":12,"column":8},"end":{"line":12,"column":89}},"7":{"start":{"line":15,"column":0},"end":{"line":15,"column":34}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":6,"column":4},"end":{"line":6,"column":5}},"loc":{"start":{"line":6,"column":61},"end":{"line":8,"column":5}},"line":6},"1":{"name":"(anonymous_1)","decl":{"start":{"line":9,"column":4},"end":{"line":9,"column":5}},"loc":{"start":{"line":9,"column":28},"end":{"line":13,"column":5}},"line":9}},"branchMap":{"0":{"loc":{"start":{"line":6,"column":16},"end":{"line":6,"column":59}},"type":"default-arg","locations":[{"start":{"line":6,"column":31},"end":{"line":6,"column":59}}],"line":6}},"s":{"0":1,"1":1,"2":1,"3":1,"4":3,"5":3,"6":3,"7":1},"f":{"0":1,"1":3},"b":{"0":[1]},"inputSourceMap":{"version":3,"file":"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/controllers/EventController.ts","sources":["/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/controllers/EventController.ts"],"names":[],"mappings":";;AACA,2DAAoD;AACpD,0DAAmD;AAEnD,MAAqB,eAAe;IAClC,YAAoB,eAAe,IAAI,sBAAY,EAAE;QAAjC,iBAAY,GAAZ,YAAY,CAAqB;IAAG,CAAC;IAEzD,KAAK,CAAC,OAAO,CAAC,GAAY,EAAE,GAAa;QACvC,MAAM,KAAK,GAAG,GAAG,CAAC,OAAO,CAAC,aAAa,CAAC;QACxC,MAAM,MAAM,GAAG,MAAM,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;QACtD,OAAO,GAAG,CAAC,MAAM,CAAC,IAAA,uBAAa,EAAC,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;IACpE,CAAC;CACF;AARD,kCAQC","sourcesContent":["import { Request, Response } from 'express';\nimport EventService from '../services/EventService';\nimport mapStatusHTTP from '../utils/mapStatusHTTP';\n\nexport default class EventController {\n  constructor(private eventService = new EventService()) {}\n\n  async findAll(req: Request, res: Response): Promise<Response> {\n    const token = req.headers.authorization;\n    const events = await this.eventService.findAll(token);\n    return res.status(mapStatusHTTP(events.status)).json(events.data);\n  }    \n}"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"147fb2faea692b1e31c125b0a94a3b5f838821be"},"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/services/EventService.ts":{"path":"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/services/EventService.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":21},"end":{"line":3,"column":52}},"2":{"start":{"line":4,"column":19},"end":{"line":4,"column":47}},"3":{"start":{"line":7,"column":8},"end":{"line":7,"column":37}},"4":{"start":{"line":8,"column":8},"end":{"line":8,"column":49}},"5":{"start":{"line":11,"column":8},"end":{"line":19,"column":9}},"6":{"start":{"line":12,"column":12},"end":{"line":15,"column":13}},"7":{"start":{"line":13,"column":31},"end":{"line":13,"column":68}},"8":{"start":{"line":14,"column":16},"end":{"line":14,"column":62}},"9":{"start":{"line":18,"column":12},"end":{"line":18,"column":99}},"10":{"start":{"line":20,"column":23},"end":{"line":20,"column":54}},"11":{"start":{"line":21,"column":8},"end":{"line":21,"column":54}},"12":{"start":{"line":24,"column":0},"end":{"line":24,"column":31}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":6,"column":4},"end":{"line":6,"column":5}},"loc":{"start":{"line":6,"column":57},"end":{"line":9,"column":5}},"line":6},"1":{"name":"(anonymous_1)","decl":{"start":{"line":10,"column":4},"end":{"line":10,"column":5}},"loc":{"start":{"line":10,"column":25},"end":{"line":22,"column":5}},"line":10}},"branchMap":{"0":{"loc":{"start":{"line":6,"column":16},"end":{"line":6,"column":55}},"type":"default-arg","locations":[{"start":{"line":6,"column":29},"end":{"line":6,"column":55}}],"line":6},"1":{"loc":{"start":{"line":12,"column":12},"end":{"line":15,"column":13}},"type":"if","locations":[{"start":{"line":12,"column":12},"end":{"line":15,"column":13}},{"start":{"line":12,"column":12},"end":{"line":15,"column":13}}],"line":12},"2":{"loc":{"start":{"line":12,"column":16},"end":{"line":12,"column":55}},"type":"binary-expr","locations":[{"start":{"line":12,"column":16},"end":{"line":12,"column":22}},{"start":{"line":12,"column":26},"end":{"line":12,"column":55}}],"line":12}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":3,"6":3,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1},"f":{"0":1,"1":3},"b":{"0":[1],"1":[1,1],"2":[3,2]},"inputSourceMap":{"version":3,"file":"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/services/EventService.ts","sources":["/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/services/EventService.ts"],"names":[],"mappings":";;AACA,qDAA8C;AAG9C,gDAAyC;AAEzC,MAAqB,YAAY;IAC/B,YAAoB,aAAa,IAAI,oBAAU,EAAE;QAA7B,eAAU,GAAV,UAAU,CAAmB;QACzC,aAAQ,GAAG,IAAI,kBAAQ,EAAE,CAAC;IADkB,CAAC;IAGrD,KAAK,CAAC,OAAO,CAAC,KAAyB;QACrC,IAAI;YACF,IAAI,CAAC,KAAK,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,KAAK,CAAC,EAAE;gBAC3C,MAAM,MAAM,GAAG,MAAM,IAAI,CAAC,UAAU,CAAC,aAAa,EAAE,CAAC;gBACrD,OAAO,EAAE,MAAM,EAAE,YAAY,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC;aAC/C;SACF;QAAC,MAAM;YACN,OAAO,EAAE,MAAM,EAAE,uBAAuB,EAAE,IAAI,EAAE,EAAE,OAAO,EAAE,uBAAuB,EAAE,EAAE,CAAC;SACxF;QACD,MAAM,MAAM,GAAG,MAAM,IAAI,CAAC,UAAU,CAAC,OAAO,EAAE,CAAC;QAC/C,OAAO,EAAE,MAAM,EAAE,YAAY,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC;IAChD,CAAC;CACF;AAhBD,+BAgBC","sourcesContent":["import { IEventModel } from \"../interfaces/events/IEventModel\";\nimport EventModel from \"../models/EventModel\";\nimport { IEvent } from \"../interfaces/events/IEvent\";\nimport { ServiceResponse } from \"../interfaces/ServiceResponse\";\nimport JwtUtils from '../utils/JwtUtils';\n\nexport default class EventService {\n  constructor(private eventModel = new EventModel()) {}\n  private jwtUtils = new JwtUtils();\n\n  async findAll(token: string | undefined): Promise<ServiceResponse<IEvent[]>> {\n    try {\n      if (!token || !this.jwtUtils.isAdmin(token)) {\n        const events = await this.eventModel.findAllOpened();\n        return { status: \"SUCCESSFUL\", data: events };\n      }\n    } catch {\n      return { status: 'INTERNAL_SERVER_ERROR', data: { message: \"Internal server error\" } };\n    }\n    const events = await this.eventModel.findAll();\n    return { status: \"SUCCESSFUL\", data: events };\n  }\n}"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"3b6e0be43c430c93d467fcf31f9ad3c1590ba1a8"},"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/models/EventModel.ts":{"path":"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/models/EventModel.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":25},"end":{"line":3,"column":69}},"2":{"start":{"line":6,"column":8},"end":{"line":6,"column":46}},"3":{"start":{"line":9,"column":22},"end":{"line":9,"column":51}},"4":{"start":{"line":10,"column":8},"end":{"line":10,"column":21}},"5":{"start":{"line":13,"column":23},"end":{"line":13,"column":49}},"6":{"start":{"line":14,"column":8},"end":{"line":14,"column":22}},"7":{"start":{"line":17,"column":23},"end":{"line":17,"column":76}},"8":{"start":{"line":18,"column":8},"end":{"line":18,"column":22}},"9":{"start":{"line":21,"column":22},"end":{"line":21,"column":51}},"10":{"start":{"line":22,"column":8},"end":{"line":22,"column":21}},"11":{"start":{"line":25,"column":22},"end":{"line":25,"column":51}},"12":{"start":{"line":26,"column":8},"end":{"line":27,"column":24}},"13":{"start":{"line":27,"column":12},"end":{"line":27,"column":24}},"14":{"start":{"line":28,"column":30},"end":{"line":28,"column":78}},"15":{"start":{"line":29,"column":8},"end":{"line":29,"column":48}},"16":{"start":{"line":32,"column":22},"end":{"line":32,"column":51}},"17":{"start":{"line":33,"column":32},"end":{"line":33,"column":105}},"18":{"start":{"line":34,"column":8},"end":{"line":34,"column":72}},"19":{"start":{"line":37,"column":29},"end":{"line":37,"column":72}},"20":{"start":{"line":38,"column":8},"end":{"line":38,"column":28}},"21":{"start":{"line":41,"column":0},"end":{"line":41,"column":29}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":5,"column":4},"end":{"line":5,"column":5}},"loc":{"start":{"line":5,"column":18},"end":{"line":7,"column":5}},"line":5},"1":{"name":"(anonymous_1)","decl":{"start":{"line":8,"column":4},"end":{"line":8,"column":5}},"loc":{"start":{"line":8,"column":23},"end":{"line":11,"column":5}},"line":8},"2":{"name":"(anonymous_2)","decl":{"start":{"line":12,"column":4},"end":{"line":12,"column":5}},"loc":{"start":{"line":12,"column":20},"end":{"line":15,"column":5}},"line":12},"3":{"name":"(anonymous_3)","decl":{"start":{"line":16,"column":4},"end":{"line":16,"column":5}},"loc":{"start":{"line":16,"column":26},"end":{"line":19,"column":5}},"line":16},"4":{"name":"(anonymous_4)","decl":{"start":{"line":20,"column":4},"end":{"line":20,"column":5}},"loc":{"start":{"line":20,"column":23},"end":{"line":23,"column":5}},"line":20},"5":{"name":"(anonymous_5)","decl":{"start":{"line":24,"column":4},"end":{"line":24,"column":5}},"loc":{"start":{"line":24,"column":27},"end":{"line":30,"column":5}},"line":24},"6":{"name":"(anonymous_6)","decl":{"start":{"line":31,"column":4},"end":{"line":31,"column":5}},"loc":{"start":{"line":31,"column":27},"end":{"line":35,"column":5}},"line":31},"7":{"name":"(anonymous_7)","decl":{"start":{"line":36,"column":4},"end":{"line":36,"column":5}},"loc":{"start":{"line":36,"column":21},"end":{"line":39,"column":5}},"line":36}},"branchMap":{"0":{"loc":{"start":{"line":26,"column":8},"end":{"line":27,"column":24}},"type":"if","locations":[{"start":{"line":26,"column":8},"end":{"line":27,"column":24}},{"start":{"line":26,"column":8},"end":{"line":27,"column":24}}],"line":26},"1":{"loc":{"start":{"line":33,"column":33},"end":{"line":33,"column":100}},"type":"cond-expr","locations":[{"start":{"line":33,"column":70},"end":{"line":33,"column":76}},{"start":{"line":33,"column":79},"end":{"line":33,"column":100}}],"line":33},"2":{"loc":{"start":{"line":33,"column":33},"end":{"line":33,"column":67}},"type":"binary-expr","locations":[{"start":{"line":33,"column":33},"end":{"line":33,"column":47}},{"start":{"line":33,"column":51},"end":{"line":33,"column":67}}],"line":33}},"s":{"0":1,"1":1,"2":3,"3":0,"4":0,"5":1,"6":1,"7":0,"8":0,"9":5,"10":5,"11":0,"12":0,"13":0,"14":0,"15":0,"16":1,"17":1,"18":1,"19":0,"20":0,"21":1},"f":{"0":3,"1":0,"2":1,"3":0,"4":5,"5":0,"6":1,"7":0},"b":{"0":[0,0],"1":[0,1],"2":[1,1]},"inputSourceMap":{"version":3,"file":"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/models/EventModel.ts","sources":["/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/models/EventModel.ts"],"names":[],"mappings":";;AACA,sEAA+D;AAI/D,MAAqB,UAAU;IAA/B;QACU,UAAK,GAAG,wBAAc,CAAC;IAuCjC,CAAC;IArCC,KAAK,CAAC,MAAM,CAAC,IAAuB;QAClC,MAAM,KAAK,GAAG,MAAM,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;QAC5C,OAAO,KAAK,CAAC;IACf,CAAC;IAED,KAAK,CAAC,OAAO;QACX,MAAM,MAAM,GAAG,MAAM,IAAI,CAAC,KAAK,CAAC,OAAO,EAAE,CAAC;QAC1C,OAAO,MAAM,CAAC;IAChB,CAAC;IAED,KAAK,CAAC,aAAa;QACjB,MAAM,MAAM,GAAG,MAAM,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,EAAE,KAAK,EAAE,EAAE,MAAM,EAAE,IAAI,EAAE,EAAE,CAAC,CAAC;QACrE,OAAO,MAAM,CAAC;IAChB,CAAC;IAED,KAAK,CAAC,QAAQ,CAAC,EAAU;QACvB,MAAM,KAAK,GAAG,MAAM,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;QAC5C,OAAO,KAAK,CAAC;IACf,CAAC;IAED,KAAK,CAAC,MAAM,CAAC,EAAU,EAAE,IAAqB;QAC5C,MAAM,KAAK,GAAG,MAAM,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;QAC5C,IAAI,CAAC,KAAK;YAAE,OAAO,IAAI,CAAC;QACxB,MAAM,aAAa,GAAG,MAAM,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,IAAI,EAAE,EAAE,KAAK,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,CAAC;QACvE,OAAO,EAAE,GAAG,KAAK,EAAE,GAAG,IAAI,EAAE,CAAC,UAAU,CAAC;IAC1C,CAAC;IAED,KAAK,CAAC,YAAY,CAAC,EAAU;QAC3B,MAAM,KAAK,GAAG,MAAM,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;QAC5C,MAAM,eAAe,GAAG,CAAA,KAAK,aAAL,KAAK,uBAAL,KAAK,CAAE,eAAyB,IAAG,CAAC,CAAC;QAC7D,MAAM,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,EAAE,eAAe,EAAE,EAAE,EAAE,KAAK,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,CAAC;IAClE,CAAC;IAED,KAAK,CAAC,MAAM,CAAC,EAAU;QACrB,MAAM,YAAY,GAAG,MAAM,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,EAAC,KAAK,EAAE,EAAC,EAAE,EAAC,EAAC,CAAC,CAAC;QAC7D,OAAO,YAAY,CAAC;IACtB,CAAC;CACF;AAxCD,6BAwCC","sourcesContent":["import { NewEntity } from \"../interfaces\";\nimport SequelizeEvent from \"../database/models/SequelizeEvent\";\nimport { IEventModel } from \"../interfaces/events/IEventModel\";\nimport { IEvent } from \"../interfaces/events/IEvent\";\n\nexport default class EventModel implements IEventModel {\n  private model = SequelizeEvent;\n\n  async create(data: NewEntity<IEvent>): Promise<IEvent> {\n    const event = await this.model.create(data);\n    return event;\n  }\n\n  async findAll(): Promise<IEvent[]> {\n    const events = await this.model.findAll();\n    return events;\n  }\n\n  async findAllOpened(): Promise<IEvent[]> {\n    const events = await this.model.findAll({ where: { isOpen: true } });\n    return events;\n  }\n\n  async findById(id: number): Promise<IEvent | null> {\n    const event = await this.model.findByPk(id);\n    return event;\n  }\n\n  async update(id: number, data: Partial<IEvent>): Promise<IEvent | null> {\n    const event = await this.model.findByPk(id);\n    if (!event) return null;\n    const modifiedEvent = await this.model.update(data, { where: { id } });\n    return { ...event, ...data }.dataValues;\n  }\n\n  async updatePlaces(id: number): Promise<void> {\n    const event = await this.model.findByPk(id);\n    const placesRemaining = event?.placesRemaining as number - 1;\n    await this.model.update({ placesRemaining }, { where: { id } });\n  }\n\n  async delete(id: number): Promise<number> {\n    const deletedEvent = await this.model.destroy({where: {id}});\n    return deletedEvent;\n  }\n}"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"031db83d14353826d0778e3a01b73f72e1e7ab69"},"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/utils/mapStatusHTTP.ts":{"path":"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/utils/mapStatusHTTP.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":4,"column":4},"end":{"line":13,"column":5}},"2":{"start":{"line":5,"column":27},"end":{"line":5,"column":38}},"3":{"start":{"line":6,"column":24},"end":{"line":6,"column":35}},"4":{"start":{"line":7,"column":29},"end":{"line":7,"column":40}},"5":{"start":{"line":8,"column":29},"end":{"line":8,"column":40}},"6":{"start":{"line":9,"column":26},"end":{"line":9,"column":37}},"7":{"start":{"line":10,"column":25},"end":{"line":10,"column":36}},"8":{"start":{"line":11,"column":38},"end":{"line":11,"column":49}},"9":{"start":{"line":12,"column":17},"end":{"line":12,"column":28}},"10":{"start":{"line":15,"column":0},"end":{"line":15,"column":32}}},"fnMap":{"0":{"name":"mapStatusHTTP","decl":{"start":{"line":3,"column":9},"end":{"line":3,"column":22}},"loc":{"start":{"line":3,"column":31},"end":{"line":14,"column":1}},"line":3}},"branchMap":{"0":{"loc":{"start":{"line":4,"column":4},"end":{"line":13,"column":5}},"type":"switch","locations":[{"start":{"line":5,"column":8},"end":{"line":5,"column":38}},{"start":{"line":6,"column":8},"end":{"line":6,"column":35}},{"start":{"line":7,"column":8},"end":{"line":7,"column":40}},{"start":{"line":8,"column":8},"end":{"line":8,"column":40}},{"start":{"line":9,"column":8},"end":{"line":9,"column":37}},{"start":{"line":10,"column":8},"end":{"line":10,"column":36}},{"start":{"line":11,"column":8},"end":{"line":11,"column":49}},{"start":{"line":12,"column":8},"end":{"line":12,"column":28}}],"line":4}},"s":{"0":1,"1":21,"2":6,"3":2,"4":8,"5":1,"6":3,"7":0,"8":1,"9":0,"10":1},"f":{"0":21},"b":{"0":[6,2,8,1,3,0,1,0]},"inputSourceMap":{"version":3,"file":"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/utils/mapStatusHTTP.ts","sources":["/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/utils/mapStatusHTTP.ts"],"names":[],"mappings":";;AAAA,SAAwB,aAAa,CAAC,MAAc;IAChD,QAAQ,MAAM,EAAE;QACd,KAAK,YAAY,CAAC,CAAC,OAAO,GAAG,CAAC;QAC9B,KAAK,SAAS,CAAC,CAAC,OAAO,GAAG,CAAC;QAC3B,KAAK,cAAc,CAAC,CAAC,OAAO,GAAG,CAAC;QAChC,KAAK,cAAc,CAAC,CAAC,OAAO,GAAG,CAAC;QAChC,KAAK,WAAW,CAAC,CAAC,OAAO,GAAG,CAAC;QAC7B,KAAK,UAAU,CAAC,CAAC,OAAO,GAAG,CAAC;QAC5B,KAAK,uBAAuB,CAAC,CAAC,OAAO,GAAG,CAAC;QACzC,OAAO,CAAC,CAAC,OAAO,GAAG,CAAC;KACrB;AACH,CAAC;AAXH,gCAWG","sourcesContent":["export default function mapStatusHTTP(status: string): number {\n    switch (status) {\n      case 'SUCCESSFUL': return 200;\n      case 'CREATED': return 201;\n      case 'INVALID_DATA': return 400;\n      case 'UNAUTHORIZED': return 401;\n      case 'NOT_FOUND': return 404;\n      case 'CONFLICT': return 409;\n      case 'INTERNAL_SERVER_ERROR': return 500;\n      default: return 500;\n    }\n  }"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"964642efa9434fbd1f5d8c7e3c8ed46e7ee038cf"},"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/routes/user.routes.ts":{"path":"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/routes/user.routes.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":18},"end":{"line":3,"column":36}},"2":{"start":{"line":4,"column":25},"end":{"line":4,"column":65}},"3":{"start":{"line":5,"column":22},"end":{"line":5,"column":59}},"4":{"start":{"line":6,"column":23},"end":{"line":6,"column":53}},"5":{"start":{"line":7,"column":15},"end":{"line":7,"column":38}},"6":{"start":{"line":8,"column":0},"end":{"line":8,"column":105}},"7":{"start":{"line":8,"column":73},"end":{"line":8,"column":103}},"8":{"start":{"line":9,"column":0},"end":{"line":9,"column":145}},"9":{"start":{"line":9,"column":112},"end":{"line":9,"column":143}},"10":{"start":{"line":10,"column":0},"end":{"line":10,"column":104}},"11":{"start":{"line":10,"column":62},"end":{"line":10,"column":102}},"12":{"start":{"line":11,"column":0},"end":{"line":11,"column":25}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":8,"column":59},"end":{"line":8,"column":60}},"loc":{"start":{"line":8,"column":73},"end":{"line":8,"column":103}},"line":8},"1":{"name":"(anonymous_1)","decl":{"start":{"line":9,"column":98},"end":{"line":9,"column":99}},"loc":{"start":{"line":9,"column":112},"end":{"line":9,"column":143}},"line":9},"2":{"name":"(anonymous_2)","decl":{"start":{"line":10,"column":48},"end":{"line":10,"column":49}},"loc":{"start":{"line":10,"column":62},"end":{"line":10,"column":102}},"line":10}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":3,"8":1,"9":2,"10":1,"11":4,"12":1},"f":{"0":3,"1":2,"2":4},"b":{},"inputSourceMap":{"version":3,"file":"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/routes/user.routes.ts","sources":["/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/routes/user.routes.ts"],"names":[],"mappings":";;AAAA,qCAAoD;AACpD,kEAA2D;AAC3D,4DAAqD;AAErD,MAAM,cAAc,GAAG,IAAI,wBAAc,EAAE,CAAC;AAC5C,MAAM,MAAM,GAAG,IAAA,gBAAM,GAAE,CAAC;AAExB,MAAM,CAAC,IAAI,CAAC,QAAQ,EAAE,qBAAW,CAAC,aAAa,EAAE,CAAC,GAAY,EAAE,GAAa,EAAE,EAAE,CAAC,cAAc,CAAC,KAAK,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC,CAAC;AAClH,MAAM,CAAC,IAAI,CAAC,SAAS,EAAE,qBAAW,CAAC,aAAa,EAAE,qBAAW,CAAC,cAAc,EAAE,CAAC,GAAY,EAAE,GAAa,EAAE,EAAE,CAAC,cAAc,CAAC,MAAM,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC,CAAC;AAChJ,MAAM,CAAC,GAAG,CAAC,mCAAmC,EAAE,CAAC,GAAY,EAAE,GAAa,EAAE,EAAE,CAAC,cAAc,CAAC,eAAe,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC,CAAC;AAE3H,kBAAe,MAAM,CAAC","sourcesContent":["import { Request, Router, Response } from 'express';\nimport UserController from '../controllers/UserController';\nimport Validations from '../middlewares/Validations';\n\nconst userController = new UserController();\nconst router = Router();\n\nrouter.post('/login', Validations.validateLogin, (req: Request, res: Response) => userController.login(req, res));\nrouter.post('/signup', Validations.validateLogin, Validations.validateSignUp, (req: Request, res: Response) => userController.signUp(req, res));\nrouter.get('/activate/:userId/:activationCode', (req: Request, res: Response) => userController.activateAccount(req, res));\n\nexport default router;"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"4ded4918920cdc522233ed941d2663f7aea70e55"},"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/controllers/UserController.ts":{"path":"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/controllers/UserController.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":22},"end":{"line":3,"column":56}},"2":{"start":{"line":4,"column":24},"end":{"line":4,"column":57}},"3":{"start":{"line":7,"column":8},"end":{"line":7,"column":39}},"4":{"start":{"line":10,"column":33},"end":{"line":10,"column":71}},"5":{"start":{"line":11,"column":8},"end":{"line":11,"column":75}},"6":{"start":{"line":14,"column":33},"end":{"line":14,"column":72}},"7":{"start":{"line":15,"column":8},"end":{"line":15,"column":75}},"8":{"start":{"line":18,"column":43},"end":{"line":18,"column":53}},"9":{"start":{"line":19,"column":8},"end":{"line":20,"column":71}},"10":{"start":{"line":20,"column":12},"end":{"line":20,"column":71}},"11":{"start":{"line":21,"column":33},"end":{"line":21,"column":103}},"12":{"start":{"line":22,"column":8},"end":{"line":22,"column":75}},"13":{"start":{"line":25,"column":0},"end":{"line":25,"column":33}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":6,"column":4},"end":{"line":6,"column":5}},"loc":{"start":{"line":6,"column":59},"end":{"line":8,"column":5}},"line":6},"1":{"name":"(anonymous_1)","decl":{"start":{"line":9,"column":4},"end":{"line":9,"column":5}},"loc":{"start":{"line":9,"column":26},"end":{"line":12,"column":5}},"line":9},"2":{"name":"(anonymous_2)","decl":{"start":{"line":13,"column":4},"end":{"line":13,"column":5}},"loc":{"start":{"line":13,"column":27},"end":{"line":16,"column":5}},"line":13},"3":{"name":"(anonymous_3)","decl":{"start":{"line":17,"column":4},"end":{"line":17,"column":5}},"loc":{"start":{"line":17,"column":36},"end":{"line":23,"column":5}},"line":17}},"branchMap":{"0":{"loc":{"start":{"line":6,"column":16},"end":{"line":6,"column":57}},"type":"default-arg","locations":[{"start":{"line":6,"column":30},"end":{"line":6,"column":57}}],"line":6},"1":{"loc":{"start":{"line":19,"column":8},"end":{"line":20,"column":71}},"type":"if","locations":[{"start":{"line":19,"column":8},"end":{"line":20,"column":71}},{"start":{"line":19,"column":8},"end":{"line":20,"column":71}}],"line":19}},"s":{"0":1,"1":1,"2":1,"3":1,"4":3,"5":3,"6":2,"7":2,"8":4,"9":4,"10":1,"11":3,"12":3,"13":1},"f":{"0":1,"1":3,"2":2,"3":4},"b":{"0":[1],"1":[1,3]},"inputSourceMap":{"version":3,"file":"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/controllers/UserController.ts","sources":["/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/controllers/UserController.ts"],"names":[],"mappings":";;AACA,yDAAkD;AAClD,0DAAmD;AAEnD,MAAqB,cAAc;IACjC,YAAoB,cAAc,IAAI,qBAAW,EAAE;QAA/B,gBAAW,GAAX,WAAW,CAAoB;IAAG,CAAC;IAEvD,KAAK,CAAC,KAAK,CAAC,GAAY,EAAE,GAAa;QACrC,MAAM,EAAE,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;QAChE,OAAO,GAAG,CAAC,MAAM,CAAC,IAAA,uBAAa,EAAC,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IACtD,CAAC;IAED,KAAK,CAAC,MAAM,CAAC,GAAY,EAAE,GAAa;QACtC,MAAM,EAAE,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;QACjE,OAAO,GAAG,CAAC,MAAM,CAAC,IAAA,uBAAa,EAAC,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IACtD,CAAC;IAED,KAAK,CAAC,eAAe,CAAC,GAAY,EAAE,GAAa;QAC/C,MAAM,EAAE,MAAM,EAAE,cAAc,EAAE,GAAG,GAAG,CAAC,MAAM,CAAC;QAC9C,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,MAAM,CAAC,MAAM,CAAC;YAAE,OAAO,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,EAAE,OAAO,EAAE,gBAAgB,EAAE,CAAC,CAAC;QAC3F,MAAM,EAAE,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,IAAI,CAAC,WAAW,CAAC,eAAe,CAAC,MAAM,CAAC,MAAM,CAAC,EAAE,cAAc,CAAC,CAAC;QAChG,OAAO,GAAG,CAAC,MAAM,CAAC,IAAA,uBAAa,EAAC,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IACtD,CAAC;CACF;AAnBD,iCAmBC","sourcesContent":["import { Request, Response } from 'express';\nimport UserService from '../services/UserService';\nimport mapStatusHTTP from '../utils/mapStatusHTTP';\n\nexport default class UserController {\n  constructor(private userService = new UserService()) {}\n  \n  async login(req: Request, res: Response): Promise<Response> {\n    const { status, data } = await this.userService.login(req.body);\n    return res.status(mapStatusHTTP(status)).json(data);\n  }\n\n  async signUp(req: Request, res: Response): Promise<Response> {\n    const { status, data } = await this.userService.signUp(req.body);\n    return res.status(mapStatusHTTP(status)).json(data);\n  }\n\n  async activateAccount(req: Request, res: Response): Promise<Response> {\n    const { userId, activationCode } = req.params;\n    if (!Number(req.params.userId)) return res.status(400).json({ message: 'Invalid userId' });\n    const { status, data } = await this.userService.activateAccount(Number(userId), activationCode);\n    return res.status(mapStatusHTTP(status)).json(data);\n  }\n}\n\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"90c75bc0a086fa622e9c4d609a271119aeae1531"},"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/services/UserService.ts":{"path":"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/services/UserService.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":20},"end":{"line":3,"column":50}},"2":{"start":{"line":4,"column":19},"end":{"line":4,"column":47}},"3":{"start":{"line":5,"column":15},"end":{"line":5,"column":34}},"4":{"start":{"line":6,"column":23},"end":{"line":6,"column":48}},"5":{"start":{"line":7,"column":31},"end":{"line":7,"column":71}},"6":{"start":{"line":8,"column":34},"end":{"line":8,"column":77}},"7":{"start":{"line":11,"column":8},"end":{"line":11,"column":35}},"8":{"start":{"line":14,"column":25},"end":{"line":14,"column":49}},"9":{"start":{"line":15,"column":26},"end":{"line":15,"column":70}},"10":{"start":{"line":16,"column":8},"end":{"line":18,"column":9}},"11":{"start":{"line":17,"column":12},"end":{"line":17,"column":97}},"12":{"start":{"line":19,"column":22},"end":{"line":19,"column":103}},"13":{"start":{"line":20,"column":8},"end":{"line":20,"column":64}},"14":{"start":{"line":23,"column":8},"end":{"line":25,"column":9}},"15":{"start":{"line":24,"column":12},"end":{"line":24,"column":88}},"16":{"start":{"line":26,"column":32},"end":{"line":26,"column":68}},"17":{"start":{"line":27,"column":39},"end":{"line":27,"column":249}},"18":{"start":{"line":28,"column":8},"end":{"line":28,"column":184}},"19":{"start":{"line":29,"column":8},"end":{"line":29,"column":165}},"20":{"start":{"line":32,"column":21},"end":{"line":32,"column":54}},"21":{"start":{"line":33,"column":8},"end":{"line":34,"column":80}},"22":{"start":{"line":34,"column":12},"end":{"line":34,"column":80}},"23":{"start":{"line":35,"column":8},"end":{"line":38,"column":9}},"24":{"start":{"line":36,"column":12},"end":{"line":36,"column":65}},"25":{"start":{"line":37,"column":12},"end":{"line":37,"column":97}},"26":{"start":{"line":39,"column":8},"end":{"line":39,"column":88}},"27":{"start":{"line":42,"column":0},"end":{"line":42,"column":30}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":10,"column":4},"end":{"line":10,"column":5}},"loc":{"start":{"line":10,"column":55},"end":{"line":12,"column":5}},"line":10},"1":{"name":"(anonymous_1)","decl":{"start":{"line":13,"column":4},"end":{"line":13,"column":5}},"loc":{"start":{"line":13,"column":22},"end":{"line":21,"column":5}},"line":13},"2":{"name":"(anonymous_2)","decl":{"start":{"line":22,"column":4},"end":{"line":22,"column":5}},"loc":{"start":{"line":22,"column":23},"end":{"line":30,"column":5}},"line":22},"3":{"name":"(anonymous_3)","decl":{"start":{"line":31,"column":4},"end":{"line":31,"column":5}},"loc":{"start":{"line":31,"column":46},"end":{"line":40,"column":5}},"line":31}},"branchMap":{"0":{"loc":{"start":{"line":10,"column":16},"end":{"line":10,"column":53}},"type":"default-arg","locations":[{"start":{"line":10,"column":28},"end":{"line":10,"column":53}}],"line":10},"1":{"loc":{"start":{"line":16,"column":8},"end":{"line":18,"column":9}},"type":"if","locations":[{"start":{"line":16,"column":8},"end":{"line":18,"column":9}},{"start":{"line":16,"column":8},"end":{"line":18,"column":9}}],"line":16},"2":{"loc":{"start":{"line":16,"column":12},"end":{"line":16,"column":134}},"type":"binary-expr","locations":[{"start":{"line":16,"column":12},"end":{"line":16,"column":22}},{"start":{"line":16,"column":26},"end":{"line":16,"column":134}}],"line":16},"3":{"loc":{"start":{"line":16,"column":61},"end":{"line":16,"column":133}},"type":"cond-expr","locations":[{"start":{"line":16,"column":106},"end":{"line":16,"column":112}},{"start":{"line":16,"column":115},"end":{"line":16,"column":133}}],"line":16},"4":{"loc":{"start":{"line":16,"column":61},"end":{"line":16,"column":103}},"type":"binary-expr","locations":[{"start":{"line":16,"column":61},"end":{"line":16,"column":79}},{"start":{"line":16,"column":83},"end":{"line":16,"column":103}}],"line":16},"5":{"loc":{"start":{"line":23,"column":8},"end":{"line":25,"column":9}},"type":"if","locations":[{"start":{"line":23,"column":8},"end":{"line":25,"column":9}},{"start":{"line":23,"column":8},"end":{"line":25,"column":9}}],"line":23},"6":{"loc":{"start":{"line":33,"column":8},"end":{"line":34,"column":80}},"type":"if","locations":[{"start":{"line":33,"column":8},"end":{"line":34,"column":80}},{"start":{"line":33,"column":8},"end":{"line":34,"column":80}}],"line":33},"7":{"loc":{"start":{"line":35,"column":8},"end":{"line":38,"column":9}},"type":"if","locations":[{"start":{"line":35,"column":8},"end":{"line":38,"column":9}},{"start":{"line":35,"column":8},"end":{"line":38,"column":9}}],"line":35},"8":{"loc":{"start":{"line":35,"column":13},"end":{"line":35,"column":76}},"type":"cond-expr","locations":[{"start":{"line":35,"column":48},"end":{"line":35,"column":54}},{"start":{"line":35,"column":57},"end":{"line":35,"column":76}}],"line":35},"9":{"loc":{"start":{"line":35,"column":13},"end":{"line":35,"column":45}},"type":"binary-expr","locations":[{"start":{"line":35,"column":13},"end":{"line":35,"column":26}},{"start":{"line":35,"column":30},"end":{"line":35,"column":45}}],"line":35}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":3,"9":3,"10":3,"11":2,"12":1,"13":1,"14":2,"15":1,"16":1,"17":1,"18":1,"19":1,"20":3,"21":3,"22":1,"23":2,"24":1,"25":1,"26":1,"27":1},"f":{"0":1,"1":3,"2":2,"3":3},"b":{"0":[1],"1":[2,1],"2":[3,2],"3":[0,2],"4":[2,2],"5":[1,1],"6":[1,2],"7":[1,1],"8":[0,2],"9":[2,2]},"inputSourceMap":{"version":3,"file":"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/services/UserService.ts","sources":["/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/services/UserService.ts"],"names":[],"mappings":"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","sourcesContent":["import { ServiceResponse } from \"../interfaces/ServiceResponse\";\nimport UserModel from \"../models/UserModel\";\nimport JwtUtils from \"../utils/JwtUtils\";\nimport { Token } from \"../interfaces\";\nimport * as bcrypt from \"bcryptjs\";\nimport { emailQueue } from \"./QueueService\";\nimport buildActivationUrl from \"../utils/activationUrlBuilder\";\nimport activationCodeGenerator from \"../utils/activationCodeGenerator\";\n\nexport default class UserService {\n  constructor(private userModel = new UserModel()) {}\n  \n  async login(user: { email: string, password: string }): Promise<ServiceResponse<Token>> {\n    const jwtUtils = new JwtUtils();\n    const foundUser = await this.userModel.findByEmail(user.email);\n    if (!foundUser || !bcrypt.compareSync(user.password, foundUser?.password)) {\n      return { status: 'INVALID_DATA', data: { message: 'Invalid username or password' } };\n    }\n    const token = jwtUtils.sign({ id: foundUser.id, email: foundUser.email, role: foundUser.role });\n      return { status: \"SUCCESSFUL\", data: { token: token } };\n  }\n  \n  async signUp(user: { email: string, username: string, password: string }): Promise<ServiceResponse<{ message: string }>> {\n    if (await this.userModel.findByEmail(user.email)) {\n      return { status: 'INVALID_DATA', data: { message: 'User already exists' } };\n    }\n    const cryptedPassword = await bcrypt.hash(user.password, 10);\n    const { id, activationCode } = await this.userModel.create({ username: user.username, email: user.email, password: cryptedPassword, role: 'user', activationCode: activationCodeGenerator.generateActivationCode(), activated: false });\n    await emailQueue.add({method: 'sendCodeEmail', email: user.email, username: user.username, code: buildActivationUrl({ id, activationCode })});\n    return { status: 'CREATED', data: { message: `${user.username} account was created. Access ${user.email} and click on the link to activate your account` } };\n  }\n\n  async activateAccount(id: number, activationCode: string): Promise<ServiceResponse<{ message: string }>> {\n    const user = await this.userModel.findById(id);\n    if(!user) return { status: 'NOT_FOUND', data: { message: 'User not found' } };\n    if(user?.activationCode === activationCode) {\n      await this.userModel.update(id, { activated: true });\n      return { status: 'SUCCESSFUL', data: { message: 'Account activated successfully' } };\n    }\n    return { status: 'INVALID_DATA', data: { message: 'Invalid activation code' } };\n  }\n}"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"930c53fb9475f15f75e697bab73987063061e06e"},"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/models/UserModel.ts":{"path":"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/models/UserModel.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":24},"end":{"line":3,"column":67}},"2":{"start":{"line":6,"column":8},"end":{"line":6,"column":45}},"3":{"start":{"line":9,"column":21},"end":{"line":9,"column":50}},"4":{"start":{"line":10,"column":8},"end":{"line":10,"column":20}},"5":{"start":{"line":13,"column":22},"end":{"line":13,"column":48}},"6":{"start":{"line":14,"column":8},"end":{"line":14,"column":21}},"7":{"start":{"line":17,"column":21},"end":{"line":17,"column":50}},"8":{"start":{"line":18,"column":8},"end":{"line":18,"column":20}},"9":{"start":{"line":21,"column":21},"end":{"line":21,"column":67}},"10":{"start":{"line":22,"column":8},"end":{"line":22,"column":20}},"11":{"start":{"line":25,"column":21},"end":{"line":25,"column":50}},"12":{"start":{"line":26,"column":8},"end":{"line":27,"column":24}},"13":{"start":{"line":27,"column":12},"end":{"line":27,"column":24}},"14":{"start":{"line":28,"column":29},"end":{"line":28,"column":77}},"15":{"start":{"line":29,"column":8},"end":{"line":29,"column":36}},"16":{"start":{"line":32,"column":28},"end":{"line":32,"column":71}},"17":{"start":{"line":33,"column":8},"end":{"line":33,"column":27}},"18":{"start":{"line":36,"column":0},"end":{"line":36,"column":28}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":5,"column":4},"end":{"line":5,"column":5}},"loc":{"start":{"line":5,"column":18},"end":{"line":7,"column":5}},"line":5},"1":{"name":"(anonymous_1)","decl":{"start":{"line":8,"column":4},"end":{"line":8,"column":5}},"loc":{"start":{"line":8,"column":23},"end":{"line":11,"column":5}},"line":8},"2":{"name":"(anonymous_2)","decl":{"start":{"line":12,"column":4},"end":{"line":12,"column":5}},"loc":{"start":{"line":12,"column":20},"end":{"line":15,"column":5}},"line":12},"3":{"name":"(anonymous_3)","decl":{"start":{"line":16,"column":4},"end":{"line":16,"column":5}},"loc":{"start":{"line":16,"column":23},"end":{"line":19,"column":5}},"line":16},"4":{"name":"(anonymous_4)","decl":{"start":{"line":20,"column":4},"end":{"line":20,"column":5}},"loc":{"start":{"line":20,"column":29},"end":{"line":23,"column":5}},"line":20},"5":{"name":"(anonymous_5)","decl":{"start":{"line":24,"column":4},"end":{"line":24,"column":5}},"loc":{"start":{"line":24,"column":27},"end":{"line":30,"column":5}},"line":24},"6":{"name":"(anonymous_6)","decl":{"start":{"line":31,"column":4},"end":{"line":31,"column":5}},"loc":{"start":{"line":31,"column":21},"end":{"line":34,"column":5}},"line":31}},"branchMap":{"0":{"loc":{"start":{"line":26,"column":8},"end":{"line":27,"column":24}},"type":"if","locations":[{"start":{"line":26,"column":8},"end":{"line":27,"column":24}},{"start":{"line":26,"column":8},"end":{"line":27,"column":24}}],"line":26}},"s":{"0":1,"1":1,"2":2,"3":1,"4":1,"5":0,"6":0,"7":3,"8":3,"9":5,"10":5,"11":1,"12":1,"13":0,"14":1,"15":1,"16":0,"17":0,"18":1},"f":{"0":2,"1":1,"2":0,"3":3,"4":5,"5":1,"6":0},"b":{"0":[0,1]},"inputSourceMap":{"version":3,"file":"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/models/UserModel.ts","sources":["/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/models/UserModel.ts"],"names":[],"mappings":";;AACA,oEAA6D;AAK7D,MAAqB,SAAS;IAA9B;QACU,UAAK,GAAG,uBAAa,CAAC;IAiChC,CAAC;IA/BC,KAAK,CAAC,MAAM,CAAC,IAAsB;QACjC,MAAM,IAAI,GAAG,MAAM,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;QAC3C,OAAO,IAAI,CAAC;IACd,CAAC;IAED,KAAK,CAAC,OAAO;QACX,MAAM,KAAK,GAAG,MAAM,IAAI,CAAC,KAAK,CAAC,OAAO,EAAE,CAAC;QACzC,OAAO,KAAK,CAAC;IACf,CAAC;IAED,KAAK,CAAC,QAAQ,CAAC,EAAU;QACvB,MAAM,IAAI,GAAG,MAAM,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;QAC3C,OAAO,IAAI,CAAC;IACd,CAAC;IAED,KAAK,CAAC,WAAW,CAAC,KAAa;QAC7B,MAAM,IAAI,GAAG,MAAM,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,EAAE,KAAK,EAAE,EAAE,KAAK,EAAE,EAAE,CAAC,CAAC;QAC5D,OAAO,IAAI,CAAC;IACd,CAAC;IAED,KAAK,CAAC,MAAM,CAAC,EAAU,EAAE,IAAoB;QAC3C,MAAM,IAAI,GAAG,MAAM,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;QAC3C,IAAI,CAAC,IAAI;YAAE,OAAO,IAAI,CAAC;QACvB,MAAM,YAAY,GAAG,MAAM,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,IAAI,EAAE,EAAE,KAAK,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,CAAC;QACtE,OAAO,EAAE,GAAG,IAAI,EAAE,GAAG,IAAI,EAAE,CAAC;IAC9B,CAAC;IAED,KAAK,CAAC,MAAM,CAAC,EAAU;QACrB,MAAM,WAAW,GAAG,MAAM,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,EAAC,KAAK,EAAE,EAAC,EAAE,EAAC,EAAC,CAAC,CAAC;QAC5D,OAAO,WAAW,CAAC;IACrB,CAAC;CACF;AAlCD,4BAkCC","sourcesContent":["import { NewEntity } from \"../interfaces\";\nimport SequelizeUser from \"../database/models/SequelizeUser\";\nimport { IUserModel } from \"../interfaces/users/IUserModel\";\nimport { IUser } from \"../interfaces/users/IUser\";\n\n\nexport default class UserModel implements IUserModel {\n  private model = SequelizeUser;\n\n  async create(data: NewEntity<IUser>): Promise<IUser> {\n    const user = await this.model.create(data);\n    return user;\n  }\n\n  async findAll(): Promise<IUser[]> {\n    const users = await this.model.findAll();\n    return users;\n  }\n\n  async findById(id: number): Promise<IUser | null> {\n    const user = await this.model.findByPk(id);\n    return user;\n  }\n\n  async findByEmail(email: string): Promise<IUser | null> {\n    const user = await this.model.findOne({ where: { email } });\n    return user;\n  }\n\n  async update(id: number, data: Partial<IUser>): Promise<IUser | null> {\n    const user = await this.model.findByPk(id);\n    if (!user) return null;\n    const modifiedUser = await this.model.update(data, { where: { id } });\n    return { ...user, ...data };\n  }\n\n  async delete(id: number): Promise<number> {\n    const deletedUser = await this.model.destroy({where: {id}});\n    return deletedUser;\n  }\n}"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"901a861d6667d6e38083a0a448c8388b65ea9cad"},"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/services/QueueService.ts":{"path":"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/services/QueueService.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":28}},"2":{"start":{"line":4,"column":14},"end":{"line":4,"column":29}},"3":{"start":{"line":5,"column":20},"end":{"line":5,"column":49}},"4":{"start":{"line":6,"column":0},"end":{"line":11,"column":3}},"5":{"start":{"line":12,"column":0},"end":{"line":34,"column":3}},"6":{"start":{"line":13,"column":4},"end":{"line":33,"column":5}},"7":{"start":{"line":14,"column":8},"end":{"line":17,"column":9}},"8":{"start":{"line":15,"column":56},"end":{"line":15,"column":59}},"9":{"start":{"line":16,"column":12},"end":{"line":16,"column":72}},"10":{"start":{"line":18,"column":8},"end":{"line":21,"column":9}},"11":{"start":{"line":19,"column":66},"end":{"line":19,"column":69}},"12":{"start":{"line":20,"column":12},"end":{"line":20,"column":90}},"13":{"start":{"line":22,"column":8},"end":{"line":25,"column":9}},"14":{"start":{"line":23,"column":66},"end":{"line":23,"column":69}},"15":{"start":{"line":24,"column":12},"end":{"line":24,"column":84}},"16":{"start":{"line":26,"column":8},"end":{"line":29,"column":9}},"17":{"start":{"line":27,"column":60},"end":{"line":27,"column":63}},"18":{"start":{"line":28,"column":12},"end":{"line":28,"column":84}},"19":{"start":{"line":32,"column":8},"end":{"line":32,"column":27}},"20":{"start":{"line":35,"column":0},"end":{"line":37,"column":2}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":12,"column":27},"end":{"line":12,"column":28}},"loc":{"start":{"line":12,"column":42},"end":{"line":34,"column":1}},"line":12}},"branchMap":{"0":{"loc":{"start":{"line":14,"column":8},"end":{"line":17,"column":9}},"type":"if","locations":[{"start":{"line":14,"column":8},"end":{"line":17,"column":9}},{"start":{"line":14,"column":8},"end":{"line":17,"column":9}}],"line":14},"1":{"loc":{"start":{"line":18,"column":8},"end":{"line":21,"column":9}},"type":"if","locations":[{"start":{"line":18,"column":8},"end":{"line":21,"column":9}},{"start":{"line":18,"column":8},"end":{"line":21,"column":9}}],"line":18},"2":{"loc":{"start":{"line":22,"column":8},"end":{"line":25,"column":9}},"type":"if","locations":[{"start":{"line":22,"column":8},"end":{"line":25,"column":9}},{"start":{"line":22,"column":8},"end":{"line":25,"column":9}}],"line":22},"3":{"loc":{"start":{"line":26,"column":8},"end":{"line":29,"column":9}},"type":"if","locations":[{"start":{"line":26,"column":8},"end":{"line":29,"column":9}},{"start":{"line":26,"column":8},"end":{"line":29,"column":9}}],"line":26}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":1},"f":{"0":0},"b":{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0]},"inputSourceMap":{"version":3,"file":"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/services/QueueService.ts","sources":["/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/services/QueueService.ts"],"names":[],"mappings":";;;AAAA,8BAA8B;AAC9B,kDAAkH;AAErG,QAAA,UAAU,GAAG,IAAI,KAAK,CAAC,qBAAqB,EAAE;IACzD,KAAK,EAAE;QACL,IAAI,EAAE,IAAI;QACV,IAAI,EAAE,OAAO;KACd;CACF,CAAC,CAAC;AAEH,kBAAU,CAAC,OAAO,CAAC,KAAK,EAAE,GAAG,EAAE,EAAE;IAC/B,IAAI;QACF,IAAI,GAAG,CAAC,IAAI,CAAC,MAAM,KAAK,eAAe,EAAE;YACvC,MAAM,EAAE,IAAI,EAAE,EAAE,KAAK,EAAE,QAAQ,EAAE,IAAI,EAAE,EAAE,GAAG,GAAG,CAAC;YAChD,MAAM,IAAA,yBAAa,EAAC,KAAK,EAAE,QAAQ,EAAE,IAAI,CAAC,CAAC;SAC5C;QACD,IAAI,GAAG,CAAC,IAAI,CAAC,MAAM,KAAK,uBAAuB,EAAE;YAC/C,MAAM,EAAE,IAAI,EAAE,EAAE,KAAK,EAAE,SAAS,EAAE,OAAO,EAAE,IAAI,EAAE,EAAE,GAAG,GAAG,CAAC;YAC1D,MAAM,IAAA,iCAAqB,EAAC,KAAK,EAAE,SAAS,EAAE,OAAO,EAAE,IAAI,CAAC,CAAC;SAC9D;QACD,IAAI,GAAG,CAAC,IAAI,CAAC,MAAM,KAAK,iBAAiB,EAAE;YACzC,MAAM,EAAE,IAAI,EAAE,EAAE,KAAK,EAAE,OAAO,EAAE,SAAS,EAAE,IAAI,EAAE,EAAE,GAAG,GAAG,CAAC;YAC1D,MAAM,IAAA,2BAAe,EAAC,KAAK,EAAE,OAAO,EAAE,SAAS,EAAE,IAAI,CAAC,CAAC;SACxD;QACD,IAAI,GAAG,CAAC,IAAI,CAAC,MAAM,KAAK,uBAAuB,EAAE;YAC/C,MAAM,EAAE,IAAI,EAAE,EAAE,KAAK,EAAE,OAAO,EAAE,SAAS,EAAE,EAAE,GAAG,GAAG,CAAC;YACpD,MAAM,IAAA,iCAAqB,EAAC,KAAK,EAAE,OAAO,EAAE,SAAS,CAAC,CAAC;SACxD;KACF;IAAC,OAAO,KAAK,EAAE;QACd,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;KACpB;AACH,CAAC,CAAC,CAAC;AAEH,kBAAe;IACb,UAAU,EAAV,kBAAU;CACX,CAAC","sourcesContent":["import * as Queue from 'bull';\nimport { sendBoughtTicketEmail, sendCodeEmail, sendInviteEmail, sendUpdatedEventEmail } from '../utils/sendEmail';\n\nexport const emailQueue = new Queue('emailAuthentication', {\n  redis: {\n    port: 6379,\n    host: 'redis',\n  },\n});\n\nemailQueue.process(async (job) => {\n  try {\n    if (job.data.method === 'sendCodeEmail') {\n      const { data: { email, username, code } } = job;\n      await sendCodeEmail(email, username, code);\n    }\n    if (job.data.method === 'sendBoughtTicketEmail') {\n      const { data: { email, eventName, visitor, date } } = job;\n      await sendBoughtTicketEmail(email, eventName, visitor, date);\n    }\n    if (job.data.method === 'sendInviteEmail') {\n      const { data: { email, visitor, eventName, code } } = job;\n      await sendInviteEmail(email, visitor, eventName, code);\n    }\n    if (job.data.method === 'sendUpdatedEventEmail') {\n      const { data: { email, visitor, eventName } } = job;\n      await sendUpdatedEventEmail(email, visitor, eventName);\n    }\n  } catch (error) {\n    console.log(error);\n  }\n});\n\nexport default {\n  emailQueue,\n};"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"9683a2cec62f9243304492e411a002f3bc23c859"},"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/utils/sendEmail.ts":{"path":"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/utils/sendEmail.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":141}},"2":{"start":{"line":4,"column":19},"end":{"line":4,"column":40}},"3":{"start":{"line":5,"column":0},"end":{"line":5,"column":25}},"4":{"start":{"line":6,"column":0},"end":{"line":13,"column":3}},"5":{"start":{"line":15,"column":4},"end":{"line":21,"column":7}},"6":{"start":{"line":23,"column":0},"end":{"line":23,"column":54}},"7":{"start":{"line":25,"column":4},"end":{"line":32,"column":7}},"8":{"start":{"line":34,"column":0},"end":{"line":34,"column":42}},"9":{"start":{"line":36,"column":4},"end":{"line":41,"column":7}},"10":{"start":{"line":43,"column":0},"end":{"line":43,"column":54}},"11":{"start":{"line":45,"column":4},"end":{"line":51,"column":7}},"12":{"start":{"line":53,"column":0},"end":{"line":53,"column":38}},"13":{"start":{"line":54,"column":0},"end":{"line":56,"column":2}}},"fnMap":{"0":{"name":"sendBoughtTicketEmail","decl":{"start":{"line":14,"column":15},"end":{"line":14,"column":36}},"loc":{"start":{"line":14,"column":70},"end":{"line":22,"column":1}},"line":14},"1":{"name":"sendInviteEmail","decl":{"start":{"line":24,"column":15},"end":{"line":24,"column":30}},"loc":{"start":{"line":24,"column":64},"end":{"line":33,"column":1}},"line":24},"2":{"name":"sendUpdatedEventEmail","decl":{"start":{"line":35,"column":15},"end":{"line":35,"column":36}},"loc":{"start":{"line":35,"column":60},"end":{"line":42,"column":1}},"line":35},"3":{"name":"sendCodeEmail","decl":{"start":{"line":44,"column":15},"end":{"line":44,"column":28}},"loc":{"start":{"line":44,"column":52},"end":{"line":52,"column":1}},"line":44}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":0,"6":1,"7":0,"8":1,"9":0,"10":1,"11":0,"12":1,"13":1},"f":{"0":0,"1":0,"2":0,"3":0},"b":{},"inputSourceMap":{"version":3,"file":"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/utils/sendEmail.ts","sources":["/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/utils/sendEmail.ts"],"names":[],"mappings":";;;AAAA,yCAAyC;AACzC,yBAAuB;AAEV,QAAA,SAAS,GAAG,UAAU,CAAC,eAAe,CAAC;IAClD,IAAI,EAAE,0BAA0B;IAChC,IAAI,EAAE,IAAI;IACV,IAAI,EAAE;QACJ,IAAI,EAAE,OAAO,CAAC,GAAG,CAAC,aAAa;QAC/B,IAAI,EAAE,OAAO,CAAC,GAAG,CAAC,iBAAiB;KACpC;CACF,CAAC,CAAC;AAEI,KAAK,UAAU,qBAAqB,CAAC,KAAa,EAAE,SAAiB,EAAE,OAAe,EAAE,IAAY;IACzG,MAAM,iBAAS,CAAC,QAAQ,CAAC;QACvB,IAAI,EAAE,yBAAyB;QAC/B,EAAE,EAAE,KAAK;QACT,OAAO,EAAE,eAAe;QACxB,IAAI,EAAE,uCAAuC,SAAS,mCAAmC,OAAO;8DACtC,IAAI,OAAO;KACtE,CAAC,CAAC;AACL,CAAC;AARD,sDAQC;AAEM,KAAK,UAAU,eAAe,CAAC,KAAa,EAAE,OAAe,EAAE,SAAiB,EAAE,IAAY;IACnG,MAAM,iBAAS,CAAC,QAAQ,CAAC;QACvB,IAAI,EAAE,yBAAyB;QAC/B,EAAE,EAAE,KAAK;QACT,OAAO,EAAE,uBAAuB;QAChC,IAAI,EAAE,iCAAiC,SAAS;+CACL,OAAO;mCACnB,IAAI,MAAM;KAC1C,CAAC,CAAC;AACL,CAAC;AATD,0CASC;AAEM,KAAK,UAAU,qBAAqB,CAAC,KAAa,EAAE,OAAe,EAAE,KAAa;IACvF,MAAM,iBAAS,CAAC,QAAQ,CAAC;QACvB,IAAI,EAAE,yBAAyB;QAC/B,EAAE,EAAE,KAAK;QACT,OAAO,EAAE,aAAa,KAAK,wCAAwC;QACnE,IAAI,EAAE,iBAAiB,KAAK,iDAAiD,OAAO,8BAA8B,KAAK,uBAAuB;KAC/I,CAAC,CAAC;AACL,CAAC;AAPD,sDAOC;AAEM,KAAK,UAAU,aAAa,CAAC,KAAY,EAAE,QAAgB,EAAE,IAAW;IAC7E,MAAM,iBAAS,CAAC,QAAQ,CAAC;QACvB,IAAI,EAAE,yBAAyB;QAC/B,EAAE,EAAE,KAAK;QACT,OAAO,EAAE,iBAAiB;QAC1B,IAAI,EAAE;MACJ,QAAQ,6DAA6D,IAAI,MAAM;KAClF,CAAC,CAAC;AACL,CAAC;AARD,sCAQC;AAED,kBAAe;IACb,aAAa;CACd,CAAC","sourcesContent":["import * as nodemailer from 'nodemailer';\nimport 'dotenv/config';\n\nexport const transport = nodemailer.createTransport({\n  host: 'sandbox.smtp.mailtrap.io',\n  port: 2525,\n  auth: {\n    user: process.env.MAILTRAP_USER,\n    pass: process.env.MAILTRAP_PASSWORD,\n  },\n});\n\nexport async function sendBoughtTicketEmail(email: string, eventName: string, visitor: string, date: string): Promise<void> {\n  await transport.sendMail({\n    from: 'event-venue@example.com',\n    to: email,\n    subject: 'Bought Ticket',\n    html: `<h1>Ticket bought by you</h1><p>The ${eventName} event ticket was purchased for ${visitor}</p>. \n    <p>Please, present this ticket on the day of the event (${date})</p>`,\n  });\n}\n\nexport async function sendInviteEmail(email: string, visitor: string, eventName: string, code: string): Promise<void> {\n  await transport.sendMail({\n    from: 'event-venue@example.com',\n    to: email,\n    subject: 'You Have Been Invited',\n    html: `<h1> You have been invited to ${eventName}</h1> \n    <p>A invite has been made in the name of ${visitor}. Access your account and get your ticket</p>\n    <p>Here is your access code: ${code}</p>`,\n  });\n}\n\nexport async function sendUpdatedEventEmail(email: string, visitor: string, event: string): Promise<void> {\n  await transport.sendMail({\n    from: 'event-venue@example.com',\n    to: email,\n    subject: `The event ${event} has undergone changes to its schedule`,\n    html: `<h1>The event ${event} has undergone changes to its schedule</h1><p>${visitor} check the new schedule of ${event} on your account.</p>`,\n  });\n}\n\nexport async function sendCodeEmail(email:string, username: string, code:string): Promise<void> {\n  await transport.sendMail({\n    from: 'event-venue@example.com',\n    to: email,\n    subject: 'Activation Code',\n    html: `<h1>Welcome to Event Venue, \n    ${username}</h1><p>Please access this page to activate your account: ${code}</p>`,\n  });\n}\n\nexport default {\n  sendCodeEmail,\n};"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"a575f2c3360b0e12223ab539fc9d5a3a6f99d59a"},"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/utils/activationUrlBuilder.ts":{"path":"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/utils/activationUrlBuilder.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":27},"end":{"line":3,"column":139}},"2":{"start":{"line":3,"column":40},"end":{"line":3,"column":139}},"3":{"start":{"line":4,"column":0},"end":{"line":4,"column":37}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":3,"column":27},"end":{"line":3,"column":28}},"loc":{"start":{"line":3,"column":40},"end":{"line":3,"column":139}},"line":3}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1},"f":{"0":1},"b":{},"inputSourceMap":{"version":3,"file":"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/utils/activationUrlBuilder.ts","sources":["/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/utils/activationUrlBuilder.ts"],"names":[],"mappings":";;AAEA,MAAM,kBAAkB,GAAG,CAAC,OAA6B,EAAU,EAAE,CACnE,GAAG,OAAO,CAAC,GAAG,CAAC,IAAI,IAAI,OAAO,CAAC,GAAG,CAAC,QAAQ,kBAAkB,OAAO,CAAC,EAAE,IAAI,OAAO,CAAC,cAAc,EAAE,CAAC;AAEtG,kBAAe,kBAAkB,CAAC","sourcesContent":["import { ActivationUrlPayload } from '../types/ActivationUrlPayload';\n\nconst buildActivationUrl = (payload: ActivationUrlPayload): string => \n  `${process.env.HOST}:${process.env.APP_PORT}/user/activate/${payload.id}/${payload.activationCode}`;\n\nexport default buildActivationUrl;"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"3c0b68f24362e193d069b20f15b824ee41085500"},"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/utils/activationCodeGenerator.ts":{"path":"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/utils/activationCodeGenerator.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":15},"end":{"line":3,"column":37}},"2":{"start":{"line":4,"column":31},"end":{"line":4,"column":75}},"3":{"start":{"line":4,"column":37},"end":{"line":4,"column":75}},"4":{"start":{"line":5,"column":0},"end":{"line":7,"column":2}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":31},"end":{"line":4,"column":32}},"loc":{"start":{"line":4,"column":37},"end":{"line":4,"column":75}},"line":4}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":1},"f":{"0":1},"b":{},"inputSourceMap":{"version":3,"file":"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/utils/activationCodeGenerator.ts","sources":["/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/utils/activationCodeGenerator.ts"],"names":[],"mappings":";;AAAA,sCAAsC;AAEtC,MAAM,sBAAsB,GAAG,GAAW,EAAE,CAC1C,MAAM,CAAC,WAAW,CAAC,EAAE,CAAC,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;AAEzC,kBAAe;IACb,sBAAsB;CACvB,CAAC","sourcesContent":["import * as crypto from 'node:crypto';\n\nconst generateActivationCode = (): string => \n  crypto.randomBytes(16).toString('hex');  \n\nexport default {\n  generateActivationCode,\n};"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"f07b37a6cb70638162868f306036dd4afeabaa6d"},"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/middlewares/Validations.ts":{"path":"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/middlewares/Validations.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":19},"end":{"line":3,"column":47}},"2":{"start":{"line":6,"column":36},"end":{"line":6,"column":44}},"3":{"start":{"line":7,"column":8},"end":{"line":9,"column":9}},"4":{"start":{"line":8,"column":12},"end":{"line":8,"column":80}},"5":{"start":{"line":10,"column":8},"end":{"line":12,"column":9}},"6":{"start":{"line":11,"column":12},"end":{"line":11,"column":78}},"7":{"start":{"line":13,"column":8},"end":{"line":15,"column":9}},"8":{"start":{"line":14,"column":12},"end":{"line":14,"column":100}},"9":{"start":{"line":16,"column":8},"end":{"line":16,"column":22}},"10":{"start":{"line":19,"column":29},"end":{"line":19,"column":37}},"11":{"start":{"line":20,"column":8},"end":{"line":22,"column":9}},"12":{"start":{"line":21,"column":12},"end":{"line":21,"column":80}},"13":{"start":{"line":23,"column":8},"end":{"line":23,"column":22}},"14":{"start":{"line":26,"column":22},"end":{"line":26,"column":47}},"15":{"start":{"line":27,"column":8},"end":{"line":36,"column":9}},"16":{"start":{"line":28,"column":12},"end":{"line":30,"column":13}},"17":{"start":{"line":29,"column":16},"end":{"line":29,"column":75}},"18":{"start":{"line":31,"column":12},"end":{"line":31,"column":47}},"19":{"start":{"line":32,"column":12},"end":{"line":32,"column":26}},"20":{"start":{"line":35,"column":12},"end":{"line":35,"column":77}},"21":{"start":{"line":39,"column":28},"end":{"line":39,"column":36}},"22":{"start":{"line":40,"column":8},"end":{"line":42,"column":9}},"23":{"start":{"line":41,"column":12},"end":{"line":41,"column":80}},"24":{"start":{"line":43,"column":8},"end":{"line":45,"column":9}},"25":{"start":{"line":44,"column":12},"end":{"line":44,"column":99}},"26":{"start":{"line":46,"column":8},"end":{"line":46,"column":22}},"27":{"start":{"line":49,"column":22},"end":{"line":49,"column":47}},"28":{"start":{"line":50,"column":25},"end":{"line":50,"column":59}},"29":{"start":{"line":51,"column":8},"end":{"line":53,"column":9}},"30":{"start":{"line":52,"column":12},"end":{"line":52,"column":69}},"31":{"start":{"line":54,"column":8},"end":{"line":54,"column":22}},"32":{"start":{"line":57,"column":22},"end":{"line":57,"column":47}},"33":{"start":{"line":58,"column":25},"end":{"line":58,"column":59}},"34":{"start":{"line":59,"column":8},"end":{"line":61,"column":9}},"35":{"start":{"line":60,"column":12},"end":{"line":60,"column":107}},"36":{"start":{"line":62,"column":8},"end":{"line":62,"column":22}},"37":{"start":{"line":65,"column":81},"end":{"line":65,"column":89}},"38":{"start":{"line":66,"column":8},"end":{"line":68,"column":9}},"39":{"start":{"line":67,"column":12},"end":{"line":67,"column":80}},"40":{"start":{"line":69,"column":8},"end":{"line":71,"column":9}},"41":{"start":{"line":70,"column":12},"end":{"line":70,"column":102}},"42":{"start":{"line":72,"column":8},"end":{"line":74,"column":9}},"43":{"start":{"line":73,"column":12},"end":{"line":73,"column":110}},"44":{"start":{"line":75,"column":8},"end":{"line":77,"column":9}},"45":{"start":{"line":76,"column":12},"end":{"line":76,"column":76}},"46":{"start":{"line":78,"column":8},"end":{"line":80,"column":9}},"47":{"start":{"line":79,"column":12},"end":{"line":79,"column":70}},"48":{"start":{"line":81,"column":8},"end":{"line":83,"column":9}},"49":{"start":{"line":82,"column":12},"end":{"line":82,"column":75}},"50":{"start":{"line":84,"column":8},"end":{"line":86,"column":9}},"51":{"start":{"line":85,"column":12},"end":{"line":85,"column":93}},"52":{"start":{"line":87,"column":8},"end":{"line":89,"column":9}},"53":{"start":{"line":88,"column":12},"end":{"line":88,"column":88}},"54":{"start":{"line":90,"column":8},"end":{"line":90,"column":22}},"55":{"start":{"line":93,"column":0},"end":{"line":93,"column":30}},"56":{"start":{"line":94,"column":0},"end":{"line":94,"column":31}},"57":{"start":{"line":95,"column":0},"end":{"line":95,"column":76}},"58":{"start":{"line":96,"column":0},"end":{"line":96,"column":76}},"59":{"start":{"line":97,"column":0},"end":{"line":97,"column":48}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":5,"column":4},"end":{"line":5,"column":5}},"loc":{"start":{"line":5,"column":41},"end":{"line":17,"column":5}},"line":5},"1":{"name":"(anonymous_1)","decl":{"start":{"line":18,"column":4},"end":{"line":18,"column":5}},"loc":{"start":{"line":18,"column":42},"end":{"line":24,"column":5}},"line":18},"2":{"name":"(anonymous_2)","decl":{"start":{"line":25,"column":4},"end":{"line":25,"column":5}},"loc":{"start":{"line":25,"column":41},"end":{"line":37,"column":5}},"line":25},"3":{"name":"(anonymous_3)","decl":{"start":{"line":38,"column":4},"end":{"line":38,"column":5}},"loc":{"start":{"line":38,"column":43},"end":{"line":47,"column":5}},"line":38},"4":{"name":"(anonymous_4)","decl":{"start":{"line":48,"column":4},"end":{"line":48,"column":5}},"loc":{"start":{"line":48,"column":41},"end":{"line":55,"column":5}},"line":48},"5":{"name":"(anonymous_5)","decl":{"start":{"line":56,"column":4},"end":{"line":56,"column":5}},"loc":{"start":{"line":56,"column":44},"end":{"line":63,"column":5}},"line":56},"6":{"name":"(anonymous_6)","decl":{"start":{"line":64,"column":4},"end":{"line":64,"column":5}},"loc":{"start":{"line":64,"column":41},"end":{"line":91,"column":5}},"line":64}},"branchMap":{"0":{"loc":{"start":{"line":7,"column":8},"end":{"line":9,"column":9}},"type":"if","locations":[{"start":{"line":7,"column":8},"end":{"line":9,"column":9}},{"start":{"line":7,"column":8},"end":{"line":9,"column":9}}],"line":7},"1":{"loc":{"start":{"line":7,"column":12},"end":{"line":7,"column":31}},"type":"binary-expr","locations":[{"start":{"line":7,"column":12},"end":{"line":7,"column":18}},{"start":{"line":7,"column":22},"end":{"line":7,"column":31}}],"line":7},"2":{"loc":{"start":{"line":10,"column":8},"end":{"line":12,"column":9}},"type":"if","locations":[{"start":{"line":10,"column":8},"end":{"line":12,"column":9}},{"start":{"line":10,"column":8},"end":{"line":12,"column":9}}],"line":10},"3":{"loc":{"start":{"line":13,"column":8},"end":{"line":15,"column":9}},"type":"if","locations":[{"start":{"line":13,"column":8},"end":{"line":15,"column":9}},{"start":{"line":13,"column":8},"end":{"line":15,"column":9}}],"line":13},"4":{"loc":{"start":{"line":20,"column":8},"end":{"line":22,"column":9}},"type":"if","locations":[{"start":{"line":20,"column":8},"end":{"line":22,"column":9}},{"start":{"line":20,"column":8},"end":{"line":22,"column":9}}],"line":20},"5":{"loc":{"start":{"line":28,"column":12},"end":{"line":30,"column":13}},"type":"if","locations":[{"start":{"line":28,"column":12},"end":{"line":30,"column":13}},{"start":{"line":28,"column":12},"end":{"line":30,"column":13}}],"line":28},"6":{"loc":{"start":{"line":40,"column":8},"end":{"line":42,"column":9}},"type":"if","locations":[{"start":{"line":40,"column":8},"end":{"line":42,"column":9}},{"start":{"line":40,"column":8},"end":{"line":42,"column":9}}],"line":40},"7":{"loc":{"start":{"line":43,"column":8},"end":{"line":45,"column":9}},"type":"if","locations":[{"start":{"line":43,"column":8},"end":{"line":45,"column":9}},{"start":{"line":43,"column":8},"end":{"line":45,"column":9}}],"line":43},"8":{"loc":{"start":{"line":51,"column":8},"end":{"line":53,"column":9}},"type":"if","locations":[{"start":{"line":51,"column":8},"end":{"line":53,"column":9}},{"start":{"line":51,"column":8},"end":{"line":53,"column":9}}],"line":51},"9":{"loc":{"start":{"line":59,"column":8},"end":{"line":61,"column":9}},"type":"if","locations":[{"start":{"line":59,"column":8},"end":{"line":61,"column":9}},{"start":{"line":59,"column":8},"end":{"line":61,"column":9}}],"line":59},"10":{"loc":{"start":{"line":66,"column":8},"end":{"line":68,"column":9}},"type":"if","locations":[{"start":{"line":66,"column":8},"end":{"line":68,"column":9}},{"start":{"line":66,"column":8},"end":{"line":68,"column":9}}],"line":66},"11":{"loc":{"start":{"line":66,"column":12},"end":{"line":66,"column":47}},"type":"binary-expr","locations":[{"start":{"line":66,"column":12},"end":{"line":66,"column":22}},{"start":{"line":66,"column":26},"end":{"line":66,"column":38}},{"start":{"line":66,"column":42},"end":{"line":66,"column":47}}],"line":66},"12":{"loc":{"start":{"line":69,"column":8},"end":{"line":71,"column":9}},"type":"if","locations":[{"start":{"line":69,"column":8},"end":{"line":71,"column":9}},{"start":{"line":69,"column":8},"end":{"line":71,"column":9}}],"line":69},"13":{"loc":{"start":{"line":72,"column":8},"end":{"line":74,"column":9}},"type":"if","locations":[{"start":{"line":72,"column":8},"end":{"line":74,"column":9}},{"start":{"line":72,"column":8},"end":{"line":74,"column":9}}],"line":72},"14":{"loc":{"start":{"line":75,"column":8},"end":{"line":77,"column":9}},"type":"if","locations":[{"start":{"line":75,"column":8},"end":{"line":77,"column":9}},{"start":{"line":75,"column":8},"end":{"line":77,"column":9}}],"line":75},"15":{"loc":{"start":{"line":78,"column":8},"end":{"line":80,"column":9}},"type":"if","locations":[{"start":{"line":78,"column":8},"end":{"line":80,"column":9}},{"start":{"line":78,"column":8},"end":{"line":80,"column":9}}],"line":78},"16":{"loc":{"start":{"line":81,"column":8},"end":{"line":83,"column":9}},"type":"if","locations":[{"start":{"line":81,"column":8},"end":{"line":83,"column":9}},{"start":{"line":81,"column":8},"end":{"line":83,"column":9}}],"line":81},"17":{"loc":{"start":{"line":81,"column":12},"end":{"line":81,"column":47}},"type":"binary-expr","locations":[{"start":{"line":81,"column":12},"end":{"line":81,"column":27}},{"start":{"line":81,"column":31},"end":{"line":81,"column":47}}],"line":81},"18":{"loc":{"start":{"line":84,"column":8},"end":{"line":86,"column":9}},"type":"if","locations":[{"start":{"line":84,"column":8},"end":{"line":86,"column":9}},{"start":{"line":84,"column":8},"end":{"line":86,"column":9}}],"line":84},"19":{"loc":{"start":{"line":84,"column":12},"end":{"line":84,"column":43}},"type":"binary-expr","locations":[{"start":{"line":84,"column":12},"end":{"line":84,"column":28}},{"start":{"line":84,"column":32},"end":{"line":84,"column":43}}],"line":84},"20":{"loc":{"start":{"line":87,"column":8},"end":{"line":89,"column":9}},"type":"if","locations":[{"start":{"line":87,"column":8},"end":{"line":89,"column":9}},{"start":{"line":87,"column":8},"end":{"line":89,"column":9}}],"line":87},"21":{"loc":{"start":{"line":87,"column":12},"end":{"line":87,"column":39}},"type":"binary-expr","locations":[{"start":{"line":87,"column":12},"end":{"line":87,"column":28}},{"start":{"line":87,"column":32},"end":{"line":87,"column":39}}],"line":87}},"s":{"0":1,"1":1,"2":10,"3":10,"4":2,"5":8,"6":1,"7":7,"8":1,"9":6,"10":3,"11":3,"12":1,"13":2,"14":17,"15":17,"16":17,"17":1,"18":16,"19":15,"20":1,"21":8,"22":8,"23":1,"24":7,"25":1,"26":6,"27":0,"28":0,"29":0,"30":0,"31":0,"32":6,"33":6,"34":6,"35":1,"36":5,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":1,"56":1,"57":1,"58":1,"59":1},"f":{"0":10,"1":3,"2":17,"3":8,"4":0,"5":6,"6":0},"b":{"0":[2,8],"1":[10,9],"2":[1,7],"3":[1,6],"4":[1,2],"5":[1,16],"6":[1,7],"7":[1,6],"8":[0,0],"9":[1,5],"10":[0,0],"11":[0,0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0]},"inputSourceMap":{"version":3,"file":"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/middlewares/Validations.ts","sources":["/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/middlewares/Validations.ts"],"names":[],"mappings":"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","sourcesContent":["import { NextFunction, Request, Response } from 'express';\nimport JwtUtils from '../utils/JwtUtils';\n\nexport default class Validations {\n  private static passwordLength = 6;\n  private static emailRegex = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$/;\n  private static dateTimeRegex = /^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{3}Z$/;\n  private static jwtUtils = new JwtUtils();\n\n  static validateLogin(req: Request, res: Response, next: NextFunction): Response | void {\n    const { email, password } = req.body;\n    if (!email || !password) {\n      return res.status(400).json({ message: 'Missing required fields' });\n    }\n    if (!Validations.emailRegex.test(email)) {\n      return res.status(400).json({ message: 'Invalid email address' });\n    }\n    if (password.length < Validations.passwordLength) {\n      return res.status(400).json({ message: 'Password must be at least 6 characters long' });\n    }\n    return next();\n  }\n\n  static validateSignUp(req: Request, res: Response, next: NextFunction): Response | void {\n    const { username } = req.body;\n    if (!username) {\n      return res.status(400).json({ message: 'Missing required fields' });\n    }\n    return next();\n  }\n\n  static validateToken(req: Request, res: Response, next: NextFunction): Response | void {\n    const token = req.headers.authorization;\n    try {\n      if (!token) {\n        return res.status(401).json({ message: 'Insert a token' });\n      }\n      Validations.jwtUtils.verify(token as string);\n      return next();\n    } catch {\n      return res.status(401).json({ message: 'Insert a valid token' });\n    }\n  }\n\n  static validateVisitor(req: Request, res: Response, next: NextFunction): Response | void {\n    const { visitor } = req.body;\n    if (!visitor) {\n      return res.status(400).json({ message: 'Missing required fields' });\n    }\n    if (visitor.length < 4) {\n      return res.status(400).json({ message: 'Visitor must be at least 4 characters long' });\n    }\n    return next();\n  }\n\n  static validateAdmin(req: Request, res: Response, next: NextFunction): Response | void {\n    const token = req.headers.authorization;\n    const { role } = Validations.jwtUtils.decode(token as string);\n    if (role !== 'admin') {\n      return res.status(401).json({ message: 'Unauthorized' });\n    }\n    return next();\n  }\n\n  static validateEmployee(req: Request, res: Response, next: NextFunction): Response | void {\n    const token = req.headers.authorization;\n    const { role } = Validations.jwtUtils.decode(token as string);\n    if (role === 'user') {\n      return res.status(401).json({ message: 'Only employees and admins can access this endpoint' });\n    }\n    return next();\n  }\n\n  static validateEvent(req: Request, res: Response, next: NextFunction): Response | void {\n    const { eventName, description, date, price, isOpen, placesRemaining } = req.body;\n    if (!eventName || !description || !date) {\n      return res.status(400).json({ message: 'Missing required fields' });\n    }\n    if (eventName.length < 3) {\n      return res.status(400).json({ message: 'Event name must be at least 3 characters long' });\n    }\n    if (description.length < 10) {\n      return res.status(400).json({ message: 'Event description must be at least 10 characters long' });\n    }\n    if (!Validations.dateTimeRegex.test(date)) {\n      return res.status(400).json({ message: 'Invalid date format' });\n    }\n    if (price < 0) {\n      return res.status(400).json({ message: 'Invalid price' });\n    }\n    if (isOpen !== true && isOpen !== false) {\n      return res.status(400).json({ message: 'Event must be open' });\n    }\n    if (!placesRemaining && price !== 0) {\n      return res.status(400).json({ message: 'Ticketless events cannot be charged.' });\n    }\n    if (!placesRemaining && !isOpen) {\n      return res.status(400).json({ message: 'Ticketless events must be open.' });\n    }\n    return next();\n  }\n}"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"d6d284e988472fd3dee14daa6266ce660d10c01f"},"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/routes/tickets.routes.ts":{"path":"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/routes/tickets.routes.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":18},"end":{"line":3,"column":36}},"2":{"start":{"line":4,"column":27},"end":{"line":4,"column":69}},"3":{"start":{"line":5,"column":22},"end":{"line":5,"column":59}},"4":{"start":{"line":6,"column":25},"end":{"line":6,"column":57}},"5":{"start":{"line":7,"column":15},"end":{"line":7,"column":38}},"6":{"start":{"line":8,"column":0},"end":{"line":8,"column":117}},"7":{"start":{"line":8,"column":76},"end":{"line":8,"column":115}},"8":{"start":{"line":9,"column":0},"end":{"line":9,"column":163}},"9":{"start":{"line":9,"column":125},"end":{"line":9,"column":161}},"10":{"start":{"line":10,"column":0},"end":{"line":10,"column":174}},"11":{"start":{"line":10,"column":132},"end":{"line":10,"column":172}},"12":{"start":{"line":11,"column":0},"end":{"line":11,"column":25}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":8,"column":62},"end":{"line":8,"column":63}},"loc":{"start":{"line":8,"column":76},"end":{"line":8,"column":115}},"line":8},"1":{"name":"(anonymous_1)","decl":{"start":{"line":9,"column":111},"end":{"line":9,"column":112}},"loc":{"start":{"line":9,"column":125},"end":{"line":9,"column":161}},"line":9},"2":{"name":"(anonymous_2)","decl":{"start":{"line":10,"column":118},"end":{"line":10,"column":119}},"loc":{"start":{"line":10,"column":132},"end":{"line":10,"column":172}},"line":10}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":6,"10":1,"11":5,"12":1},"f":{"0":1,"1":6,"2":5},"b":{},"inputSourceMap":{"version":3,"file":"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/routes/tickets.routes.ts","sources":["/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/routes/tickets.routes.ts"],"names":[],"mappings":";;AAAA,qCAAoD;AACpD,sEAA+D;AAC/D,4DAAqD;AAErD,MAAM,gBAAgB,GAAG,IAAI,0BAAgB,EAAE,CAAC;AAChD,MAAM,MAAM,GAAG,IAAA,gBAAM,GAAE,CAAC;AAExB,MAAM,CAAC,GAAG,CAAC,YAAY,EAAE,qBAAW,CAAC,aAAa,EAAE,CAAC,GAAY,EAAE,GAAa,EAAE,EAAE,CAAC,gBAAgB,CAAC,YAAY,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC,CAAC;AAC9H,MAAM,CAAC,IAAI,CAAC,qBAAqB,EAAE,qBAAW,CAAC,aAAa,EAAE,qBAAW,CAAC,eAAe,EAAE,CAAC,GAAY,EAAE,GAAa,EAAE,EAAE,CAAC,gBAAgB,CAAC,SAAS,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC,CAAC;AAClK,MAAM,CAAC,KAAK,CAAC,0BAA0B,EAAE,qBAAW,CAAC,aAAa,EAAE,qBAAW,CAAC,gBAAgB,EAAE,CAAC,GAAY,EAAE,GAAa,EAAE,EAAE,CAAC,gBAAgB,CAAC,aAAa,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC,CAAC;AAE7K,kBAAe,MAAM,CAAC","sourcesContent":["import { Request, Router, Response } from 'express';\nimport TicketController from '../controllers/TicketController';\nimport Validations from '../middlewares/Validations';\n\nconst ticketController = new TicketController();\nconst router = Router();\n\nrouter.get('/mytickets', Validations.validateToken, (req: Request, res: Response) => ticketController.getMyTickets(req, res));\nrouter.post('/buyticket/:eventId', Validations.validateToken, Validations.validateVisitor, (req: Request, res: Response) => ticketController.buyTicket(req, res));\nrouter.patch('/reclaimticket/:ticketId', Validations.validateToken, Validations.validateEmployee, (req: Request, res: Response) => ticketController.reclaimTicket(req, res));\n\nexport default router;"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"05089473c653261fb7cfb07e106b4269da7d0d09"},"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/controllers/TicketController.ts":{"path":"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/controllers/TicketController.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":24},"end":{"line":3,"column":60}},"2":{"start":{"line":4,"column":24},"end":{"line":4,"column":57}},"3":{"start":{"line":7,"column":8},"end":{"line":7,"column":43}},"4":{"start":{"line":10,"column":22},"end":{"line":10,"column":47}},"5":{"start":{"line":11,"column":24},"end":{"line":11,"column":68}},"6":{"start":{"line":12,"column":8},"end":{"line":12,"column":91}},"7":{"start":{"line":15,"column":28},"end":{"line":15,"column":36}},"8":{"start":{"line":16,"column":28},"end":{"line":16,"column":38}},"9":{"start":{"line":17,"column":22},"end":{"line":17,"column":47}},"10":{"start":{"line":18,"column":8},"end":{"line":20,"column":9}},"11":{"start":{"line":19,"column":12},"end":{"line":19,"column":72}},"12":{"start":{"line":22,"column":23},"end":{"line":22,"column":83}},"13":{"start":{"line":23,"column":8},"end":{"line":23,"column":89}},"14":{"start":{"line":26,"column":29},"end":{"line":26,"column":39}},"15":{"start":{"line":27,"column":30},"end":{"line":27,"column":38}},"16":{"start":{"line":28,"column":8},"end":{"line":30,"column":9}},"17":{"start":{"line":29,"column":12},"end":{"line":29,"column":73}},"18":{"start":{"line":32,"column":33},"end":{"line":32,"column":93}},"19":{"start":{"line":33,"column":8},"end":{"line":33,"column":75}},"20":{"start":{"line":36,"column":0},"end":{"line":36,"column":35}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":6,"column":4},"end":{"line":6,"column":5}},"loc":{"start":{"line":6,"column":63},"end":{"line":8,"column":5}},"line":6},"1":{"name":"(anonymous_1)","decl":{"start":{"line":9,"column":4},"end":{"line":9,"column":5}},"loc":{"start":{"line":9,"column":33},"end":{"line":13,"column":5}},"line":9},"2":{"name":"(anonymous_2)","decl":{"start":{"line":14,"column":4},"end":{"line":14,"column":5}},"loc":{"start":{"line":14,"column":30},"end":{"line":24,"column":5}},"line":14},"3":{"name":"(anonymous_3)","decl":{"start":{"line":25,"column":4},"end":{"line":25,"column":5}},"loc":{"start":{"line":25,"column":34},"end":{"line":34,"column":5}},"line":25}},"branchMap":{"0":{"loc":{"start":{"line":6,"column":16},"end":{"line":6,"column":61}},"type":"default-arg","locations":[{"start":{"line":6,"column":32},"end":{"line":6,"column":61}}],"line":6},"1":{"loc":{"start":{"line":18,"column":8},"end":{"line":20,"column":9}},"type":"if","locations":[{"start":{"line":18,"column":8},"end":{"line":20,"column":9}},{"start":{"line":18,"column":8},"end":{"line":20,"column":9}}],"line":18},"2":{"loc":{"start":{"line":28,"column":8},"end":{"line":30,"column":9}},"type":"if","locations":[{"start":{"line":28,"column":8},"end":{"line":30,"column":9}},{"start":{"line":28,"column":8},"end":{"line":30,"column":9}}],"line":28}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":6,"8":6,"9":6,"10":6,"11":1,"12":5,"13":5,"14":5,"15":5,"16":5,"17":1,"18":4,"19":4,"20":1},"f":{"0":1,"1":1,"2":6,"3":5},"b":{"0":[1],"1":[1,5],"2":[1,4]},"inputSourceMap":{"version":3,"file":"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/controllers/TicketController.ts","sources":["/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/controllers/TicketController.ts"],"names":[],"mappings":";;AACA,6DAAsD;AACtD,0DAAmD;AAEnD,MAAqB,gBAAgB;IACnC,YAAoB,gBAAgB,IAAI,uBAAa,EAAE;QAAnC,kBAAa,GAAb,aAAa,CAAsB;IAAG,CAAC;IAE3D,KAAK,CAAC,YAAY,CAAC,GAAY,EAAE,GAAa;QAC5C,MAAM,KAAK,GAAG,GAAG,CAAC,OAAO,CAAC,aAAa,CAAC;QACxC,MAAM,OAAO,GAAG,MAAM,IAAI,CAAC,aAAa,CAAC,YAAY,CAAC,KAAe,CAAC,CAAC;QACvE,OAAO,GAAG,CAAC,MAAM,CAAC,IAAA,uBAAa,EAAC,OAAO,CAAC,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;IACtE,CAAC;IAED,KAAK,CAAC,SAAS,CAAC,GAAY,EAAE,GAAa;QACzC,MAAM,EAAE,OAAO,EAAE,GAAG,GAAG,CAAC,IAAI,CAAC;QAC7B,MAAM,EAAE,OAAO,EAAE,GAAG,GAAG,CAAC,MAAM,CAAC;QAC/B,MAAM,KAAK,GAAG,GAAG,CAAC,OAAO,CAAC,aAAa,CAAC;QACxC,IAAG,CAAC,MAAM,CAAC,OAAO,CAAC,EAAE;YACnB,OAAO,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,EAAE,OAAO,EAAE,iBAAiB,EAAE,CAAC,CAAC;SAC7D;QAAA,CAAC;QACF,MAAM,MAAM,GAAG,MAAM,IAAI,CAAC,aAAa,CAAC,SAAS,CAAC,CAAC,OAAO,EAAE,OAAO,EAAE,KAAe,CAAC,CAAC;QACtF,OAAO,GAAG,CAAC,MAAM,CAAC,IAAA,uBAAa,EAAC,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;IACpE,CAAC;IAED,KAAK,CAAC,aAAa,CAAC,GAAY,EAAE,GAAa;QAC7C,MAAM,EAAE,QAAQ,EAAE,GAAG,GAAG,CAAC,MAAM,CAAC;QAChC,MAAM,EAAE,SAAS,EAAE,GAAG,GAAG,CAAC,IAAI,CAAC;QAC/B,IAAG,CAAC,MAAM,CAAC,QAAQ,CAAC,EAAE;YACpB,OAAO,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,EAAE,OAAO,EAAE,kBAAkB,EAAE,CAAC,CAAC;SAC9D;QAAA,CAAC;QACF,MAAM,EAAE,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,IAAI,CAAC,aAAa,CAAC,aAAa,CAAC,CAAC,QAAQ,EAAE,SAAS,CAAC,CAAC;QACtF,OAAO,GAAG,CAAC,MAAM,CAAC,IAAA,uBAAa,EAAC,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IACtD,CAAC;CACF;AA7BD,mCA6BC","sourcesContent":["import { Request, Response } from 'express';\nimport TicketService from '../services/TicketService';\nimport mapStatusHTTP from '../utils/mapStatusHTTP';\n\nexport default class TicketController {\n  constructor(private ticketService = new TicketService()) {}\n\n  async getMyTickets(req: Request, res: Response): Promise<Response> {\n    const token = req.headers.authorization;\n    const tickets = await this.ticketService.getMyTickets(token as string);\n    return res.status(mapStatusHTTP(tickets.status)).json(tickets.data);\n  }\n\n  async buyTicket(req: Request, res: Response): Promise<Response> {\n    const { visitor } = req.body;\n    const { eventId } = req.params;\n    const token = req.headers.authorization;\n    if(!Number(eventId)) {\n      return res.status(400).json({ message: 'Invalid eventId' });\n    };\n    const ticket = await this.ticketService.buyTicket(+eventId, visitor, token as string);\n    return res.status(mapStatusHTTP(ticket.status)).json(ticket.data);\n  }\n\n  async reclaimTicket(req: Request, res: Response): Promise<Response> {\n    const { ticketId } = req.params;\n    const { accessKey } = req.body;\n    if(!Number(ticketId)) {\n      return res.status(400).json({ message: 'Invalid ticketId' });\n    };\n    const { status, data } = await this.ticketService.reclaimTicket(+ticketId, accessKey);\n    return res.status(mapStatusHTTP(status)).json(data);\n  }\n}"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"8bfcf74faf4ff669c542352f5f2df4fc4f232d98"},"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/services/TicketService.ts":{"path":"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/services/TicketService.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":22},"end":{"line":3,"column":54}},"2":{"start":{"line":4,"column":19},"end":{"line":4,"column":47}},"3":{"start":{"line":5,"column":21},"end":{"line":5,"column":52}},"4":{"start":{"line":6,"column":15},"end":{"line":6,"column":34}},"5":{"start":{"line":7,"column":23},"end":{"line":7,"column":48}},"6":{"start":{"line":10,"column":8},"end":{"line":10,"column":39}},"7":{"start":{"line":11,"column":8},"end":{"line":11,"column":37}},"8":{"start":{"line":12,"column":8},"end":{"line":12,"column":49}},"9":{"start":{"line":19,"column":23},"end":{"line":19,"column":53}},"10":{"start":{"line":20,"column":24},"end":{"line":20,"column":68}},"11":{"start":{"line":21,"column":8},"end":{"line":21,"column":55}},"12":{"start":{"line":24,"column":22},"end":{"line":24,"column":61}},"13":{"start":{"line":25,"column":8},"end":{"line":26,"column":81}},"14":{"start":{"line":26,"column":12},"end":{"line":26,"column":81}},"15":{"start":{"line":27,"column":8},"end":{"line":28,"column":134}},"16":{"start":{"line":28,"column":12},"end":{"line":28,"column":134}},"17":{"start":{"line":29,"column":8},"end":{"line":31,"column":9}},"18":{"start":{"line":30,"column":12},"end":{"line":30,"column":106}},"19":{"start":{"line":32,"column":8},"end":{"line":34,"column":9}},"20":{"start":{"line":33,"column":12},"end":{"line":33,"column":83}},"21":{"start":{"line":35,"column":8},"end":{"line":35,"column":53}},"22":{"start":{"line":38,"column":22},"end":{"line":38,"column":59}},"23":{"start":{"line":39,"column":8},"end":{"line":40,"column":25}},"24":{"start":{"line":40,"column":12},"end":{"line":40,"column":25}},"25":{"start":{"line":41,"column":30},"end":{"line":41,"column":57}},"26":{"start":{"line":42,"column":26},"end":{"line":42,"column":54}},"27":{"start":{"line":43,"column":23},"end":{"line":43,"column":115}},"28":{"start":{"line":44,"column":8},"end":{"line":44,"column":52}},"29":{"start":{"line":45,"column":8},"end":{"line":45,"column":153}},"30":{"start":{"line":46,"column":8},"end":{"line":46,"column":51}},"31":{"start":{"line":50,"column":23},"end":{"line":50,"column":64}},"32":{"start":{"line":51,"column":8},"end":{"line":52,"column":82}},"33":{"start":{"line":52,"column":12},"end":{"line":52,"column":82}},"34":{"start":{"line":53,"column":8},"end":{"line":54,"column":87}},"35":{"start":{"line":54,"column":12},"end":{"line":54,"column":87}},"36":{"start":{"line":55,"column":8},"end":{"line":56,"column":93}},"37":{"start":{"line":56,"column":12},"end":{"line":56,"column":93}},"38":{"start":{"line":57,"column":8},"end":{"line":57,"column":69}},"39":{"start":{"line":58,"column":8},"end":{"line":58,"column":140}},"40":{"start":{"line":62,"column":0},"end":{"line":62,"column":32}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":9,"column":4},"end":{"line":9,"column":5}},"loc":{"start":{"line":9,"column":100},"end":{"line":13,"column":5}},"line":9},"1":{"name":"(anonymous_1)","decl":{"start":{"line":18,"column":4},"end":{"line":18,"column":5}},"loc":{"start":{"line":18,"column":30},"end":{"line":22,"column":5}},"line":18},"2":{"name":"(anonymous_2)","decl":{"start":{"line":23,"column":4},"end":{"line":23,"column":5}},"loc":{"start":{"line":23,"column":37},"end":{"line":36,"column":5}},"line":23},"3":{"name":"(anonymous_3)","decl":{"start":{"line":37,"column":4},"end":{"line":37,"column":5}},"loc":{"start":{"line":37,"column":45},"end":{"line":47,"column":5}},"line":37},"4":{"name":"(anonymous_4)","decl":{"start":{"line":49,"column":4},"end":{"line":49,"column":5}},"loc":{"start":{"line":49,"column":45},"end":{"line":59,"column":5}},"line":49}},"branchMap":{"0":{"loc":{"start":{"line":9,"column":16},"end":{"line":9,"column":57}},"type":"default-arg","locations":[{"start":{"line":9,"column":30},"end":{"line":9,"column":57}}],"line":9},"1":{"loc":{"start":{"line":9,"column":59},"end":{"line":9,"column":98}},"type":"default-arg","locations":[{"start":{"line":9,"column":72},"end":{"line":9,"column":98}}],"line":9},"2":{"loc":{"start":{"line":25,"column":8},"end":{"line":26,"column":81}},"type":"if","locations":[{"start":{"line":25,"column":8},"end":{"line":26,"column":81}},{"start":{"line":25,"column":8},"end":{"line":26,"column":81}}],"line":25},"3":{"loc":{"start":{"line":27,"column":8},"end":{"line":28,"column":134}},"type":"if","locations":[{"start":{"line":27,"column":8},"end":{"line":28,"column":134}},{"start":{"line":27,"column":8},"end":{"line":28,"column":134}}],"line":27},"4":{"loc":{"start":{"line":29,"column":8},"end":{"line":31,"column":9}},"type":"if","locations":[{"start":{"line":29,"column":8},"end":{"line":31,"column":9}},{"start":{"line":29,"column":8},"end":{"line":31,"column":9}}],"line":29},"5":{"loc":{"start":{"line":29,"column":12},"end":{"line":29,"column":65}},"type":"binary-expr","locations":[{"start":{"line":29,"column":12},"end":{"line":29,"column":34}},{"start":{"line":29,"column":38},"end":{"line":29,"column":65}}],"line":29},"6":{"loc":{"start":{"line":32,"column":8},"end":{"line":34,"column":9}},"type":"if","locations":[{"start":{"line":32,"column":8},"end":{"line":34,"column":9}},{"start":{"line":32,"column":8},"end":{"line":34,"column":9}}],"line":32},"7":{"loc":{"start":{"line":39,"column":8},"end":{"line":40,"column":25}},"type":"if","locations":[{"start":{"line":39,"column":8},"end":{"line":40,"column":25}},{"start":{"line":39,"column":8},"end":{"line":40,"column":25}}],"line":39},"8":{"loc":{"start":{"line":51,"column":8},"end":{"line":52,"column":82}},"type":"if","locations":[{"start":{"line":51,"column":8},"end":{"line":52,"column":82}},{"start":{"line":51,"column":8},"end":{"line":52,"column":82}}],"line":51},"9":{"loc":{"start":{"line":53,"column":8},"end":{"line":54,"column":87}},"type":"if","locations":[{"start":{"line":53,"column":8},"end":{"line":54,"column":87}},{"start":{"line":53,"column":8},"end":{"line":54,"column":87}}],"line":53},"10":{"loc":{"start":{"line":55,"column":8},"end":{"line":56,"column":93}},"type":"if","locations":[{"start":{"line":55,"column":8},"end":{"line":56,"column":93}},{"start":{"line":55,"column":8},"end":{"line":56,"column":93}}],"line":55}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":5,"13":5,"14":1,"15":4,"16":1,"17":3,"18":1,"19":2,"20":1,"21":1,"22":5,"23":5,"24":4,"25":1,"26":1,"27":1,"28":1,"29":1,"30":1,"31":4,"32":4,"33":1,"34":3,"35":1,"36":2,"37":1,"38":1,"39":1,"40":1},"f":{"0":1,"1":1,"2":5,"3":5,"4":4},"b":{"0":[1],"1":[1],"2":[1,4],"3":[1,3],"4":[1,2],"5":[3,2],"6":[1,1],"7":[4,1],"8":[1,3],"9":[1,2],"10":[1,1]},"inputSourceMap":{"version":3,"file":"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/services/TicketService.ts","sources":["/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/services/TicketService.ts"],"names":[],"mappings":"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","sourcesContent":["import TicketModel from \"../models/TicketModel\";\nimport { ITicket } from \"../interfaces/tickets/ITicket\";\nimport { ServiceResponse, ServiceResponseError } from \"../interfaces/ServiceResponse\";\nimport JwtUtils from \"../utils/JwtUtils\";\nimport EventModel from \"../models/EventModel\";\nimport * as bcrypt from \"bcryptjs\";\nimport { IEvent } from \"../interfaces/events/IEvent\";\nimport { emailQueue } from \"./QueueService\";\n\nexport default class TicketService {\n  constructor (private ticketModel = new TicketModel(), private eventModel = new EventModel()) {}\n  private jwtUtils = new JwtUtils();\n\n  // async findAll(): Promise<ServiceResponse<ITicket[]>> {\n  //   const tickets = await this.ticketModel.findAll();\n  //   return { status: \"SUCCESSFUL\", data: tickets };\n  // }\n\n  async getMyTickets(token: string): Promise<ServiceResponse<ITicket[]>> {\n    const userId = this.jwtUtils.decode(token).id;\n    const tickets = await this.ticketModel.findMyTickets(userId);\n    return { status: \"SUCCESSFUL\", data: tickets };\n  }\n\n  async eventAvailability(eventId: number): Promise<ServiceResponse<IEvent>> {\n    const event = await this.eventModel.findById(eventId);\n    if (!event) return { status: 'NOT_FOUND', data: { message: 'Event not found' } };\n    if (!event.isOpen) return { status : 'UNAUTHORIZED', data: { message: 'Event is closed. Contact your administrator for more information.' } };\n    if (!event.placesRemaining && event.placesRemaining !== 0) {\n      return { status: 'INVALID_DATA', data: { message: 'This event does not require a ticket.' } };\n    }\n    if (Number(event.placesRemaining) < 1) {\n      return { status: 'INVALID_DATA', data: { message: 'Event is full.' } };\n    }\n    return { status: 'SUCCESSFUL', data: event };\n  }\n\n  async buyTicket(eventId: number, visitor: string, token: string): Promise<ServiceResponse<ITicket>> {\n    const event = await this.eventAvailability(eventId);\n    if (event.status !== 'SUCCESSFUL') return event as ServiceResponseError;\n    const { id, email } = this.jwtUtils.decode(token);\n    const accessKey = bcrypt.hashSync(visitor, 10);\n    const ticket = await this.ticketModel.create({ eventId, userId: id, visitor, reclaimed: false, accessKey });\n    await this.eventModel.updatePlaces(eventId);\n    await emailQueue.add({ method: 'sendBoughtTicketEmail', email, eventName: event.data.eventName, visitor, date: event.data.date });\n    return { status: 'CREATED', data: ticket };\n  };\n\n  async reclaimTicket(ticketId: number, accessKey: string): Promise<ServiceResponse<{message: string}>> {\n    const ticket = await this.ticketModel.findById(ticketId);\n    if (!ticket) return { status: 'NOT_FOUND', data: { message: 'Ticket not found' } };\n    if (ticket.accessKey !== accessKey) return { status: 'INVALID_DATA', data: { message: 'Invalid access key' } };\n    if (ticket.reclaimed) return { status: 'INVALID_DATA', data: { message: 'Ticket already reclaimed' } };\n    await this.ticketModel.update(ticketId, { reclaimed: true });\n    return { status: 'SUCCESSFUL', data: { message: `${ticket.visitor}'s ticket (id: ${ticketId}) has been reclaimed successfully.` } };\n  };\n};"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"3f6295f054caa57561bf5ecbc8a5f09367b33568"},"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/models/TicketModel.ts":{"path":"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/models/TicketModel.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":26},"end":{"line":3,"column":71}},"2":{"start":{"line":4,"column":24},"end":{"line":4,"column":67}},"3":{"start":{"line":7,"column":8},"end":{"line":7,"column":47}},"4":{"start":{"line":10,"column":23},"end":{"line":10,"column":52}},"5":{"start":{"line":11,"column":8},"end":{"line":11,"column":22}},"6":{"start":{"line":14,"column":24},"end":{"line":14,"column":50}},"7":{"start":{"line":15,"column":8},"end":{"line":15,"column":23}},"8":{"start":{"line":18,"column":23},"end":{"line":18,"column":52}},"9":{"start":{"line":19,"column":8},"end":{"line":19,"column":22}},"10":{"start":{"line":22,"column":24},"end":{"line":22,"column":134}},"11":{"start":{"line":23,"column":8},"end":{"line":23,"column":23}},"12":{"start":{"line":26,"column":24},"end":{"line":26,"column":71}},"13":{"start":{"line":27,"column":8},"end":{"line":27,"column":23}},"14":{"start":{"line":30,"column":23},"end":{"line":30,"column":52}},"15":{"start":{"line":31,"column":8},"end":{"line":32,"column":24}},"16":{"start":{"line":32,"column":12},"end":{"line":32,"column":24}},"17":{"start":{"line":33,"column":31},"end":{"line":33,"column":79}},"18":{"start":{"line":34,"column":8},"end":{"line":34,"column":49}},"19":{"start":{"line":37,"column":30},"end":{"line":37,"column":73}},"20":{"start":{"line":38,"column":8},"end":{"line":38,"column":29}},"21":{"start":{"line":41,"column":0},"end":{"line":41,"column":30}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":6,"column":4},"end":{"line":6,"column":5}},"loc":{"start":{"line":6,"column":18},"end":{"line":8,"column":5}},"line":6},"1":{"name":"(anonymous_1)","decl":{"start":{"line":9,"column":4},"end":{"line":9,"column":5}},"loc":{"start":{"line":9,"column":23},"end":{"line":12,"column":5}},"line":9},"2":{"name":"(anonymous_2)","decl":{"start":{"line":13,"column":4},"end":{"line":13,"column":5}},"loc":{"start":{"line":13,"column":20},"end":{"line":16,"column":5}},"line":13},"3":{"name":"(anonymous_3)","decl":{"start":{"line":17,"column":4},"end":{"line":17,"column":5}},"loc":{"start":{"line":17,"column":23},"end":{"line":20,"column":5}},"line":17},"4":{"name":"(anonymous_4)","decl":{"start":{"line":21,"column":4},"end":{"line":21,"column":5}},"loc":{"start":{"line":21,"column":28},"end":{"line":24,"column":5}},"line":21},"5":{"name":"(anonymous_5)","decl":{"start":{"line":25,"column":4},"end":{"line":25,"column":5}},"loc":{"start":{"line":25,"column":32},"end":{"line":28,"column":5}},"line":25},"6":{"name":"(anonymous_6)","decl":{"start":{"line":29,"column":4},"end":{"line":29,"column":5}},"loc":{"start":{"line":29,"column":27},"end":{"line":35,"column":5}},"line":29},"7":{"name":"(anonymous_7)","decl":{"start":{"line":36,"column":4},"end":{"line":36,"column":5}},"loc":{"start":{"line":36,"column":21},"end":{"line":39,"column":5}},"line":36}},"branchMap":{"0":{"loc":{"start":{"line":31,"column":8},"end":{"line":32,"column":24}},"type":"if","locations":[{"start":{"line":31,"column":8},"end":{"line":32,"column":24}},{"start":{"line":31,"column":8},"end":{"line":32,"column":24}}],"line":31}},"s":{"0":1,"1":1,"2":1,"3":2,"4":1,"5":1,"6":0,"7":0,"8":4,"9":4,"10":0,"11":0,"12":1,"13":1,"14":1,"15":1,"16":0,"17":1,"18":1,"19":0,"20":0,"21":1},"f":{"0":2,"1":1,"2":0,"3":4,"4":0,"5":1,"6":1,"7":0},"b":{"0":[0,1]},"inputSourceMap":{"version":3,"file":"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/models/TicketModel.ts","sources":["/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/models/TicketModel.ts"],"names":[],"mappings":";;AACA,wEAAiE;AAIjE,oEAA6D;AAG7D,MAAqB,WAAW;IAAhC;QACU,UAAK,GAAG,yBAAe,CAAC;IAsClC,CAAC;IApCC,KAAK,CAAC,MAAM,CAAC,IAAwB;QACnC,MAAM,MAAM,GAAG,MAAM,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;QAC7C,OAAO,MAAM,CAAC;IAChB,CAAC;IAED,KAAK,CAAC,OAAO;QACX,MAAM,OAAO,GAAG,MAAM,IAAI,CAAC,KAAK,CAAC,OAAO,EAAE,CAAC;QAC3C,OAAO,OAAO,CAAC;IACjB,CAAC;IAED,KAAK,CAAC,QAAQ,CAAC,EAAU;QACvB,MAAM,MAAM,GAAG,MAAM,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;QAC7C,OAAO,MAAM,CAAC;IAChB,CAAC;IAED,KAAK,CAAC,aAAa,CAAC,EAAU;QAC5B,MAAM,OAAO,GAAG,MAAM,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,EAAE,KAAK,EAAE,EAAE,OAAO,EAAE,EAAE,EAAE,EAAE,OAAO,EAAE,EAAE,KAAK,EAAE,uBAAa,EAAE,EAAE,EAAE,OAAO,EAAE,EAAE,CAAC,CAAC;QACrH,OAAO,OAAO,CAAC;IACjB,CAAC;IAED,KAAK,CAAC,aAAa,CAAC,MAAc;QAChC,MAAM,OAAO,GAAG,MAAM,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,EAAE,KAAK,EAAE,EAAE,MAAM,EAAE,EAAE,CAAC,CAAC;QAChE,OAAO,OAAO,CAAC;IACjB,CAAC;IAED,KAAK,CAAC,MAAM,CAAC,EAAU,EAAE,IAAsB;QAC7C,MAAM,MAAM,GAAG,MAAM,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;QAC7C,IAAI,CAAC,MAAM;YAAE,OAAO,IAAI,CAAC;QACzB,MAAM,cAAc,GAAG,MAAM,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,IAAI,EAAE,EAAE,KAAK,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,CAAC;QACxE,OAAO,EAAE,GAAG,MAAM,EAAE,GAAG,IAAI,EAAE,CAAC,UAAU,CAAC;IAC3C,CAAC;IAED,KAAK,CAAC,MAAM,CAAC,EAAU;QACrB,MAAM,aAAa,GAAG,MAAM,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,EAAE,KAAK,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,CAAC;QAClE,OAAO,aAAa,CAAC;IACvB,CAAC;CACF;AAvCD,8BAuCC","sourcesContent":["import { NewEntity } from \"../interfaces\";\nimport SequelizeTicket from \"../database/models/SequelizeTicket\";\nimport { ITicketModel } from \"../interfaces/tickets/ITicketModel\";\nimport { ITicket } from \"../interfaces/tickets/ITicket\";\nimport SequelizeEvent from \"../database/models/SequelizeEvent\";\nimport SequelizeUser from \"../database/models/SequelizeUser\";\nimport { ITicketUsers } from \"../interfaces/tickets/ITicketUsers\";\n\nexport default class TicketModel implements ITicketModel {\n  private model = SequelizeTicket;\n\n  async create(data: NewEntity<ITicket>): Promise<ITicket> {\n    const ticket = await this.model.create(data);\n    return ticket;\n  }\n\n  async findAll(): Promise<ITicket[]> {\n    const tickets = await this.model.findAll();\n    return tickets;\n  }\n\n  async findById(id: number): Promise<ITicket | null> {\n    const ticket = await this.model.findByPk(id);\n    return ticket;\n  }\n\n  async findByEventId(id: number): Promise<ITicket[]> {\n    const tickets = await this.model.findAll({ where: { eventId: id }, include: { model: SequelizeUser, as: 'users' } });\n    return tickets;\n  }\n\n  async findMyTickets(userId: number): Promise<ITicket[]> {\n    const tickets = await this.model.findAll({ where: { userId } });\n    return tickets;\n  }\n\n  async update(id: number, data: Partial<ITicket>): Promise<ITicket | null> {\n    const ticket = await this.model.findByPk(id);\n    if (!ticket) return null;\n    const modifiedTicket = await this.model.update(data, { where: { id } });\n    return { ...ticket, ...data }.dataValues;\n  }\n\n  async delete(id: number): Promise<number> {\n    const deletedTicket = await this.model.destroy({ where: { id } });\n    return deletedTicket;\n  }\n}"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"2adda9f68a60d884d855d58ab8ccac8fe18b0571"},"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/routes/admin.routes.ts":{"path":"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/routes/admin.routes.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":18},"end":{"line":3,"column":36}},"2":{"start":{"line":4,"column":26},"end":{"line":4,"column":67}},"3":{"start":{"line":5,"column":22},"end":{"line":5,"column":59}},"4":{"start":{"line":6,"column":24},"end":{"line":6,"column":55}},"5":{"start":{"line":7,"column":15},"end":{"line":7,"column":38}},"6":{"start":{"line":8,"column":0},"end":{"line":8,"column":209}},"7":{"start":{"line":8,"column":171},"end":{"line":8,"column":207}},"8":{"start":{"line":9,"column":0},"end":{"line":9,"column":192}},"9":{"start":{"line":9,"column":153},"end":{"line":9,"column":190}},"10":{"start":{"line":10,"column":0},"end":{"line":10,"column":168}},"11":{"start":{"line":10,"column":125},"end":{"line":10,"column":166}},"12":{"start":{"line":11,"column":0},"end":{"line":11,"column":165}},"13":{"start":{"line":11,"column":126},"end":{"line":11,"column":163}},"14":{"start":{"line":12,"column":0},"end":{"line":12,"column":166}},"15":{"start":{"line":12,"column":127},"end":{"line":12,"column":164}},"16":{"start":{"line":13,"column":0},"end":{"line":13,"column":163}},"17":{"start":{"line":13,"column":125},"end":{"line":13,"column":161}},"18":{"start":{"line":14,"column":0},"end":{"line":14,"column":25}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":8,"column":157},"end":{"line":8,"column":158}},"loc":{"start":{"line":8,"column":171},"end":{"line":8,"column":207}},"line":8},"1":{"name":"(anonymous_1)","decl":{"start":{"line":9,"column":139},"end":{"line":9,"column":140}},"loc":{"start":{"line":9,"column":153},"end":{"line":9,"column":190}},"line":9},"2":{"name":"(anonymous_2)","decl":{"start":{"line":10,"column":111},"end":{"line":10,"column":112}},"loc":{"start":{"line":10,"column":125},"end":{"line":10,"column":166}},"line":10},"3":{"name":"(anonymous_3)","decl":{"start":{"line":11,"column":112},"end":{"line":11,"column":113}},"loc":{"start":{"line":11,"column":126},"end":{"line":11,"column":163}},"line":11},"4":{"name":"(anonymous_4)","decl":{"start":{"line":12,"column":113},"end":{"line":12,"column":114}},"loc":{"start":{"line":12,"column":127},"end":{"line":12,"column":164}},"line":12},"5":{"name":"(anonymous_5)","decl":{"start":{"line":13,"column":111},"end":{"line":13,"column":112}},"loc":{"start":{"line":13,"column":125},"end":{"line":13,"column":161}},"line":13}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":0,"8":1,"9":0,"10":1,"11":0,"12":1,"13":0,"14":1,"15":0,"16":1,"17":0,"18":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0},"b":{},"inputSourceMap":{"version":3,"file":"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/routes/admin.routes.ts","sources":["/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/routes/admin.routes.ts"],"names":[],"mappings":";;AAAA,qCAAoD;AACpD,oEAA6D;AAC7D,4DAAqD;AAErD,MAAM,eAAe,GAAG,IAAI,yBAAe,EAAE,CAAC;AAC9C,MAAM,MAAM,GAAG,IAAA,gBAAM,GAAE,CAAC;AAExB,MAAM,CAAC,IAAI,CAAC,8BAA8B,EAAE,qBAAW,CAAC,aAAa,EAAE,qBAAW,CAAC,aAAa,EAAE,qBAAW,CAAC,eAAe,EAAE,CAAC,GAAY,EAAE,GAAa,EAAE,EAAE,CAAC,eAAe,CAAC,UAAU,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC,CAAC;AACtM,MAAM,CAAC,IAAI,CAAC,cAAc,EAAE,qBAAW,CAAC,aAAa,EAAE,qBAAW,CAAC,aAAa,EAAE,qBAAW,CAAC,aAAa,EAAE,CAAC,GAAY,EAAE,GAAa,EAAE,EAAE,CAAC,eAAe,CAAC,WAAW,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC,CAAC;AACrL,MAAM,CAAC,GAAG,CAAC,wBAAwB,EAAE,qBAAW,CAAC,aAAa,EAAE,qBAAW,CAAC,aAAa,EAAE,CAAC,GAAY,EAAE,GAAa,EAAE,EAAE,CAAC,eAAe,CAAC,eAAe,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC,CAAC;AACvK,MAAM,CAAC,KAAK,CAAC,uBAAuB,EAAE,qBAAW,CAAC,aAAa,EAAE,qBAAW,CAAC,aAAa,EAAE,CAAC,GAAY,EAAE,GAAa,EAAE,EAAE,CAAC,eAAe,CAAC,WAAW,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC,CAAC;AACpK,MAAM,CAAC,MAAM,CAAC,uBAAuB,EAAE,qBAAW,CAAC,aAAa,EAAE,qBAAW,CAAC,aAAa,EAAE,CAAC,GAAY,EAAE,GAAa,EAAE,EAAE,CAAC,eAAe,CAAC,WAAW,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC,CAAC;AACrK,MAAM,CAAC,MAAM,CAAC,qBAAqB,EAAE,qBAAW,CAAC,aAAa,EAAE,qBAAW,CAAC,aAAa,EAAE,CAAC,GAAY,EAAE,GAAa,EAAE,EAAE,CAAC,eAAe,CAAC,UAAU,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC,CAAC;AAElK,kBAAe,MAAM,CAAC","sourcesContent":["import { Request, Router, Response } from 'express';\nimport AdminController from '../controllers/AdminController';\nimport Validations from '../middlewares/Validations';\n\nconst adminController = new AdminController();\nconst router = Router();\n\nrouter.post('/inviteUser/:userId/:eventId', Validations.validateToken, Validations.validateAdmin, Validations.validateVisitor, (req: Request, res: Response) => adminController.inviteUser(req, res));\nrouter.post('/createEvent', Validations.validateToken, Validations.validateAdmin, Validations.validateEvent, (req: Request, res: Response) => adminController.createEvent(req, res));\nrouter.get('/eventTickets/:eventId', Validations.validateToken, Validations.validateAdmin, (req: Request, res: Response) => adminController.getEventTickets(req, res));\nrouter.patch('/updateEvent/:eventId', Validations.validateToken, Validations.validateAdmin, (req: Request, res: Response) => adminController.updateEvent(req, res));\nrouter.delete('/deleteEvent/:eventId', Validations.validateToken, Validations.validateAdmin, (req: Request, res: Response) => adminController.deleteEvent(req, res));\nrouter.delete('/deleteUser/:userId', Validations.validateToken, Validations.validateAdmin, (req: Request, res: Response) => adminController.deleteUser(req, res));\n\nexport default router;"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"05ceec00e5672e1e7d86b08f2f640cd3e10757dd"},"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/controllers/AdminController.ts":{"path":"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/controllers/AdminController.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":23},"end":{"line":3,"column":58}},"2":{"start":{"line":4,"column":24},"end":{"line":4,"column":57}},"3":{"start":{"line":7,"column":8},"end":{"line":7,"column":41}},"4":{"start":{"line":10,"column":36},"end":{"line":10,"column":46}},"5":{"start":{"line":11,"column":28},"end":{"line":11,"column":36}},"6":{"start":{"line":12,"column":33},"end":{"line":12,"column":95}},"7":{"start":{"line":13,"column":8},"end":{"line":13,"column":75}},"8":{"start":{"line":16,"column":33},"end":{"line":16,"column":78}},"9":{"start":{"line":17,"column":8},"end":{"line":17,"column":75}},"10":{"start":{"line":20,"column":28},"end":{"line":20,"column":38}},"11":{"start":{"line":21,"column":8},"end":{"line":22,"column":73}},"12":{"start":{"line":22,"column":12},"end":{"line":22,"column":73}},"13":{"start":{"line":23,"column":33},"end":{"line":23,"column":82}},"14":{"start":{"line":24,"column":8},"end":{"line":24,"column":75}},"15":{"start":{"line":27,"column":28},"end":{"line":27,"column":38}},"16":{"start":{"line":28,"column":33},"end":{"line":28,"column":88}},"17":{"start":{"line":29,"column":8},"end":{"line":29,"column":75}},"18":{"start":{"line":32,"column":28},"end":{"line":32,"column":38}},"19":{"start":{"line":33,"column":8},"end":{"line":34,"column":73}},"20":{"start":{"line":34,"column":12},"end":{"line":34,"column":73}},"21":{"start":{"line":35,"column":33},"end":{"line":35,"column":78}},"22":{"start":{"line":36,"column":8},"end":{"line":36,"column":75}},"23":{"start":{"line":39,"column":27},"end":{"line":39,"column":37}},"24":{"start":{"line":40,"column":8},"end":{"line":41,"column":72}},"25":{"start":{"line":41,"column":12},"end":{"line":41,"column":72}},"26":{"start":{"line":42,"column":33},"end":{"line":42,"column":76}},"27":{"start":{"line":43,"column":8},"end":{"line":43,"column":75}},"28":{"start":{"line":46,"column":0},"end":{"line":46,"column":34}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":6,"column":4},"end":{"line":6,"column":5}},"loc":{"start":{"line":6,"column":61},"end":{"line":8,"column":5}},"line":6},"1":{"name":"(anonymous_1)","decl":{"start":{"line":9,"column":4},"end":{"line":9,"column":5}},"loc":{"start":{"line":9,"column":31},"end":{"line":14,"column":5}},"line":9},"2":{"name":"(anonymous_2)","decl":{"start":{"line":15,"column":4},"end":{"line":15,"column":5}},"loc":{"start":{"line":15,"column":32},"end":{"line":18,"column":5}},"line":15},"3":{"name":"(anonymous_3)","decl":{"start":{"line":19,"column":4},"end":{"line":19,"column":5}},"loc":{"start":{"line":19,"column":36},"end":{"line":25,"column":5}},"line":19},"4":{"name":"(anonymous_4)","decl":{"start":{"line":26,"column":4},"end":{"line":26,"column":5}},"loc":{"start":{"line":26,"column":32},"end":{"line":30,"column":5}},"line":26},"5":{"name":"(anonymous_5)","decl":{"start":{"line":31,"column":4},"end":{"line":31,"column":5}},"loc":{"start":{"line":31,"column":32},"end":{"line":37,"column":5}},"line":31},"6":{"name":"(anonymous_6)","decl":{"start":{"line":38,"column":4},"end":{"line":38,"column":5}},"loc":{"start":{"line":38,"column":31},"end":{"line":44,"column":5}},"line":38}},"branchMap":{"0":{"loc":{"start":{"line":6,"column":16},"end":{"line":6,"column":59}},"type":"default-arg","locations":[{"start":{"line":6,"column":31},"end":{"line":6,"column":59}}],"line":6},"1":{"loc":{"start":{"line":21,"column":8},"end":{"line":22,"column":73}},"type":"if","locations":[{"start":{"line":21,"column":8},"end":{"line":22,"column":73}},{"start":{"line":21,"column":8},"end":{"line":22,"column":73}}],"line":21},"2":{"loc":{"start":{"line":33,"column":8},"end":{"line":34,"column":73}},"type":"if","locations":[{"start":{"line":33,"column":8},"end":{"line":34,"column":73}},{"start":{"line":33,"column":8},"end":{"line":34,"column":73}}],"line":33},"3":{"loc":{"start":{"line":40,"column":8},"end":{"line":41,"column":72}},"type":"if","locations":[{"start":{"line":40,"column":8},"end":{"line":41,"column":72}},{"start":{"line":40,"column":8},"end":{"line":41,"column":72}}],"line":40}},"s":{"0":1,"1":1,"2":1,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":1},"f":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},"b":{"0":[1],"1":[0,0],"2":[0,0],"3":[0,0]},"inputSourceMap":{"version":3,"file":"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/controllers/AdminController.ts","sources":["/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/controllers/AdminController.ts"],"names":[],"mappings":"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","sourcesContent":["import { Request, Response } from 'express';\nimport AdminService from '../services/AdminService';\nimport mapStatusHTTP from '../utils/mapStatusHTTP';\n\nexport default class AdminController {\n  constructor(private adminService = new AdminService()) {}\n  \n  async inviteUser(req: Request, res: Response): Promise<Response> {\n    const { userId, eventId } = req.params;\n    const { visitor } = req.body;\n\n    const { data, status } = await this.adminService.inviteUser(+userId, +eventId, visitor);\n    return res.status(mapStatusHTTP(status)).json(data);\n  }\n\n  async createEvent(req: Request, res: Response): Promise<Response> {\n    const { data, status } = await this.adminService.createEvent(req.body);\n    return res.status(mapStatusHTTP(status)).json(data);\n  }\n\n  async getEventTickets(req: Request, res: Response): Promise<Response> {\n    const { eventId } = req.params;\n    if(!Number(eventId)) return res.status(400).json({ message: 'Invalid event id' });\n    const { data, status } = await this.adminService.getEventTickets(+eventId);\n    return res.status(mapStatusHTTP(status)).json(data);\n  }\n\n  async updateEvent(req: Request, res: Response): Promise<Response> {\n    const { eventId } = req.params;\n    const { data, status } = await this.adminService.updateEvent(+eventId, req.body);\n    return res.status(mapStatusHTTP(status)).json(data);\n  }\n\n  async deleteEvent(req: Request, res: Response): Promise<Response> {\n    const { eventId } = req.params;\n    if (!Number(eventId)) return res.status(400).json({ message: 'Invalid event id' });\n    const { data, status } = await this.adminService.deleteEvent(+eventId);\n    return res.status(mapStatusHTTP(status)).json(data);\n  }\n\n  async deleteUser(req: Request, res: Response): Promise<Response> {\n    const { userId } = req.params;\n    if (!Number(userId)) return res.status(400).json({ message: 'Invalid user id' });\n    const { data, status } = await this.adminService.deleteUser(+userId);\n    return res.status(mapStatusHTTP(status)).json(data);\n  }\n}"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"745dd1d7822673e247f45302148472031d4d147f"},"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/services/AdminService.ts":{"path":"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/services/AdminService.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":21},"end":{"line":3,"column":52}},"2":{"start":{"line":4,"column":22},"end":{"line":4,"column":54}},"3":{"start":{"line":5,"column":20},"end":{"line":5,"column":50}},"4":{"start":{"line":6,"column":15},"end":{"line":6,"column":34}},"5":{"start":{"line":7,"column":23},"end":{"line":7,"column":48}},"6":{"start":{"line":10,"column":8},"end":{"line":10,"column":37}},"7":{"start":{"line":11,"column":8},"end":{"line":11,"column":35}},"8":{"start":{"line":12,"column":8},"end":{"line":12,"column":39}},"9":{"start":{"line":15,"column":21},"end":{"line":15,"column":58}},"10":{"start":{"line":16,"column":8},"end":{"line":17,"column":80}},"11":{"start":{"line":17,"column":12},"end":{"line":17,"column":80}},"12":{"start":{"line":18,"column":22},"end":{"line":18,"column":61}},"13":{"start":{"line":19,"column":8},"end":{"line":20,"column":81}},"14":{"start":{"line":20,"column":12},"end":{"line":20,"column":81}},"15":{"start":{"line":21,"column":8},"end":{"line":22,"column":126}},"16":{"start":{"line":22,"column":12},"end":{"line":22,"column":126}},"17":{"start":{"line":23,"column":23},"end":{"line":23,"column":141}},"18":{"start":{"line":24,"column":8},"end":{"line":24,"column":149}},"19":{"start":{"line":25,"column":8},"end":{"line":25,"column":51}},"20":{"start":{"line":28,"column":22},"end":{"line":28,"column":56}},"21":{"start":{"line":29,"column":8},"end":{"line":29,"column":50}},"22":{"start":{"line":32,"column":24},"end":{"line":32,"column":69}},"23":{"start":{"line":33,"column":8},"end":{"line":33,"column":55}},"24":{"start":{"line":36,"column":22},"end":{"line":36,"column":60}},"25":{"start":{"line":37,"column":8},"end":{"line":38,"column":81}},"26":{"start":{"line":38,"column":12},"end":{"line":38,"column":81}},"27":{"start":{"line":39,"column":29},"end":{"line":39,"column":69}},"28":{"start":{"line":40,"column":8},"end":{"line":44,"column":9}},"29":{"start":{"line":41,"column":12},"end":{"line":43,"column":15}},"30":{"start":{"line":42,"column":16},"end":{"line":42,"column":166}},"31":{"start":{"line":45,"column":8},"end":{"line":45,"column":53}},"32":{"start":{"line":48,"column":22},"end":{"line":48,"column":59}},"33":{"start":{"line":49,"column":8},"end":{"line":50,"column":81}},"34":{"start":{"line":50,"column":12},"end":{"line":50,"column":81}},"35":{"start":{"line":51,"column":8},"end":{"line":51,"column":100}},"36":{"start":{"line":54,"column":21},"end":{"line":54,"column":56}},"37":{"start":{"line":55,"column":8},"end":{"line":56,"column":80}},"38":{"start":{"line":56,"column":12},"end":{"line":56,"column":80}},"39":{"start":{"line":57,"column":8},"end":{"line":57,"column":98}},"40":{"start":{"line":60,"column":0},"end":{"line":60,"column":31}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":9,"column":4},"end":{"line":9,"column":5}},"loc":{"start":{"line":9,"column":139},"end":{"line":13,"column":5}},"line":9},"1":{"name":"(anonymous_1)","decl":{"start":{"line":14,"column":4},"end":{"line":14,"column":5}},"loc":{"start":{"line":14,"column":47},"end":{"line":26,"column":5}},"line":14},"2":{"name":"(anonymous_2)","decl":{"start":{"line":27,"column":4},"end":{"line":27,"column":5}},"loc":{"start":{"line":27,"column":28},"end":{"line":30,"column":5}},"line":27},"3":{"name":"(anonymous_3)","decl":{"start":{"line":31,"column":4},"end":{"line":31,"column":5}},"loc":{"start":{"line":31,"column":35},"end":{"line":34,"column":5}},"line":31},"4":{"name":"(anonymous_4)","decl":{"start":{"line":35,"column":4},"end":{"line":35,"column":5}},"loc":{"start":{"line":35,"column":32},"end":{"line":46,"column":5}},"line":35},"5":{"name":"(anonymous_5)","decl":{"start":{"line":41,"column":33},"end":{"line":41,"column":34}},"loc":{"start":{"line":41,"column":45},"end":{"line":43,"column":13}},"line":41},"6":{"name":"(anonymous_6)","decl":{"start":{"line":47,"column":4},"end":{"line":47,"column":5}},"loc":{"start":{"line":47,"column":31},"end":{"line":52,"column":5}},"line":47},"7":{"name":"(anonymous_7)","decl":{"start":{"line":53,"column":4},"end":{"line":53,"column":5}},"loc":{"start":{"line":53,"column":29},"end":{"line":58,"column":5}},"line":53}},"branchMap":{"0":{"loc":{"start":{"line":9,"column":16},"end":{"line":9,"column":55}},"type":"default-arg","locations":[{"start":{"line":9,"column":29},"end":{"line":9,"column":55}}],"line":9},"1":{"loc":{"start":{"line":9,"column":57},"end":{"line":9,"column":94}},"type":"default-arg","locations":[{"start":{"line":9,"column":69},"end":{"line":9,"column":94}}],"line":9},"2":{"loc":{"start":{"line":9,"column":96},"end":{"line":9,"column":137}},"type":"default-arg","locations":[{"start":{"line":9,"column":110},"end":{"line":9,"column":137}}],"line":9},"3":{"loc":{"start":{"line":16,"column":8},"end":{"line":17,"column":80}},"type":"if","locations":[{"start":{"line":16,"column":8},"end":{"line":17,"column":80}},{"start":{"line":16,"column":8},"end":{"line":17,"column":80}}],"line":16},"4":{"loc":{"start":{"line":19,"column":8},"end":{"line":20,"column":81}},"type":"if","locations":[{"start":{"line":19,"column":8},"end":{"line":20,"column":81}},{"start":{"line":19,"column":8},"end":{"line":20,"column":81}}],"line":19},"5":{"loc":{"start":{"line":21,"column":8},"end":{"line":22,"column":126}},"type":"if","locations":[{"start":{"line":21,"column":8},"end":{"line":22,"column":126}},{"start":{"line":21,"column":8},"end":{"line":22,"column":126}}],"line":21},"6":{"loc":{"start":{"line":37,"column":8},"end":{"line":38,"column":81}},"type":"if","locations":[{"start":{"line":37,"column":8},"end":{"line":38,"column":81}},{"start":{"line":37,"column":8},"end":{"line":38,"column":81}}],"line":37},"7":{"loc":{"start":{"line":40,"column":8},"end":{"line":44,"column":9}},"type":"if","locations":[{"start":{"line":40,"column":8},"end":{"line":44,"column":9}},{"start":{"line":40,"column":8},"end":{"line":44,"column":9}}],"line":40},"8":{"loc":{"start":{"line":49,"column":8},"end":{"line":50,"column":81}},"type":"if","locations":[{"start":{"line":49,"column":8},"end":{"line":50,"column":81}},{"start":{"line":49,"column":8},"end":{"line":50,"column":81}}],"line":49},"9":{"loc":{"start":{"line":55,"column":8},"end":{"line":56,"column":80}},"type":"if","locations":[{"start":{"line":55,"column":8},"end":{"line":56,"column":80}},{"start":{"line":55,"column":8},"end":{"line":56,"column":80}}],"line":55}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":1},"f":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0},"b":{"0":[1],"1":[1],"2":[1],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0]},"inputSourceMap":{"version":3,"file":"/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/services/AdminService.ts","sources":["/home/pedro/Computação/Trybe/Projetos/event-venue-management/app/backend/src/services/AdminService.ts"],"names":[],"mappings":"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","sourcesContent":["import { ITicket } from \"../interfaces/tickets/ITicket\";\nimport { ServiceResponse } from \"../interfaces/ServiceResponse\";\nimport EventModel from \"../models/EventModel\";\nimport TicketModel from \"../models/TicketModel\";\nimport UserModel from \"../models/UserModel\";\nimport * as bcrypt from \"bcryptjs\";\nimport { emailQueue } from \"./QueueService\";\nimport { IEvent } from \"../interfaces/events/IEvent\";\nimport { NewEntity } from \"../interfaces\";\nimport { ITicketUsers } from \"../interfaces/tickets/ITicketUsers\";\n\nexport default class AdminService {\n  constructor (private eventModel = new EventModel(), private userModel = new UserModel(), private ticketModel = new TicketModel()) {}\n\n  async inviteUser(userId: number, eventId: number, visitor: string): Promise<ServiceResponse<ITicket>> {\n    const user = await this.userModel.findById(userId);\n    if (!user) return { status: 'NOT_FOUND', data: { message: 'User not found' } };\n    const event = await this.eventModel.findById(eventId);\n    if (!event) return { status: 'NOT_FOUND', data: { message: 'Event not found' } };\n    if (event.isOpen) return { status: 'UNAUTHORIZED', data: { message: 'Event is not closed. Acquire it through /buytickets route' } };\n    const ticket = await this.ticketModel.create({ eventId, userId, visitor, reclaimed: false, accessKey: bcrypt.hashSync(visitor, 10) });\n    emailQueue.add({ method: 'sendInviteEmail', email: user.email, visitor, eventName: event.eventName, code: ticket.accessKey });\n    return { status: 'CREATED', data: ticket };\n  }\n\n  async createEvent(data: NewEntity<IEvent>): Promise<ServiceResponse<IEvent>> {\n    const event = await this.eventModel.create(data);\n    return { status: 'CREATED', data: event };\n  }\n\n  async getEventTickets(eventId: number): Promise<ServiceResponse<ITicketUsers[]>> {\n    const tickets = await this.ticketModel.findByEventId(eventId) as ITicketUsers[];\n    return { status: 'SUCCESSFUL', data: tickets };\n  }\n\n  async updateEvent(id: number, data: Partial<IEvent>): Promise<ServiceResponse<IEvent>> {\n    const event = await this.eventModel.update(id, data);\n    if (!event) return { status: 'NOT_FOUND', data: { message: 'Event not found' } };\n    const eventTickets = await this.ticketModel.findByEventId(id) as ITicketUsers[];\n    if (Object.keys(data).includes('date')) {\n      eventTickets.forEach((ticket) => {\n        emailQueue.add({ method: 'sendUpdatedEventEmail', email: ticket.users[0].email, visitor: ticket.visitor, eventName: event.eventName });\n      })\n    }\n    return { status: 'SUCCESSFUL', data: event };\n  }\n\n  async deleteEvent(eventId: number): Promise<ServiceResponse<{ message: string }>> {\n    const event = await this.eventModel.delete(eventId);\n    if (!event) return { status: 'NOT_FOUND', data: { message: 'Event not found' } };\n    return { status: 'SUCCESSFUL', data: { message: `Event id(${eventId}) has been deleted` } };\n  }\n\n  async deleteUser(userId: number): Promise<ServiceResponse<{ message: string }>> {\n    const user = await this.userModel.delete(userId);\n    if (!user) return { status: 'NOT_FOUND', data: { message: 'User not found' } };\n    return { status: 'SUCCESSFUL', data: { message: `User id(${userId}) has been deleted` } };\n  }\n}"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"66994c4e9e16707d1912f98be8eea88ba5f4b57e"}}